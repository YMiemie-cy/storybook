<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Finalize.ai - Integrated Editor</title>
    <link rel="stylesheet" href="reset.css" />
    <link
      rel="stylesheet"
      href="./framework/Laucher/Modules/pickr/classic.min.css"
    />
    <link rel="stylesheet" href="./framework/Laucher/Modules/tippy/tippy.css" />
    <link
      rel="stylesheet"
      href="./framework/Laucher/Modules/codemirror/codemirror.min.css"
    />
    <link
      rel="stylesheet"
      href="./framework/Laucher/Modules/codemirror/darcula.min.css"
    />
    <link rel="stylesheet" href="./UIEditor.css" />
    <link rel="stylesheet" href="./UIEditor2.css" />
  </head>
  <body style="font-family: Arial, sans-serif">
    <nav>
      <div class="left"></div>
      <div class="center">
        <div class="pageList">
          <div class="page-container active" data-page="1">
            <div class="page-content"></div>
            <p>Page1</p>
          </div>
        </div>
        <div class="pageButtons">
          <div class="page-add-button"></div>
          <div class="page-delete-button"></div>
        </div>
      </div>
      <div class="right">
        <div class="version-button">
          <img src="./framework/Assets/editor/version.svg" alt="" />
          <p>Version</p>
        </div>
        <div class="build-button">
          <img src="./framework/Assets/editor/build.svg" alt="" />
          <p>Build</p>
        </div>
        <div class="run-button">
          <img src="./framework/Assets/editor/run.svg" alt="" />
          <p>Run</p>
        </div>
      </div>
    </nav>
    <div id="editor">
      <div class="wrapper">
        <div class="components">
          <div class="image-params"></div>
          <p
            class="text-background-clip"
            style="
              background-image: linear-gradient(
                90deg,
                #9c81f2 20.09%,
                rgba(255, 255, 255, 0.73) 80.37%
              );
            "
          >
            Modules
          </p>
          <p class="title">Layout</p>
          <div class="layout-wrap flex-wrap">
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/2-hstack.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="HStack"
                  class="component-contain move"
                  style="min-width: 100px; min-height: 100px; position: unset"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                HStack
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/1-vstack.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="VStack"
                  class="component-contain move"
                  style="min-width: 100px; min-height: 100px; position: unset"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                VStack
              </div>
            </div>
          </div>
          <p class="title">Image Modules</p>
          <div class="image-modules-wrap flex-wrap">
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/5-imageup.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="ImgLoader"
                  class="component-contain draggableBox"
                  style="width: 100px; height: 50px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                ImgLoader
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/13-image-display.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="ImgViewer"
                  class="component-contain draggableBox"
                  style="width: 100px; height: 50px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                ImgViewer
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/23-canvas.svg')
                    no-repeat center center;

                  background-size: contain;
                "
              >
                <div
                  id="ImgCanvas"
                  class="component-contain draggableBox"
                  style="width: 100px; height: 50px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                Canvas
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/24-image.svg')
                    no-repeat center center;

                  background-size: contain;
                "
              >
                <div
                  id="Image"
                  class="component-contain draggableBox"
                  style="width: 100px; height: 50px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                Image
              </div>
            </div>
          </div>
          <p class="title">Parameters</p>
          <div class="parameters-wrap flex-wrap">
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/19-slider.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="Slider"
                  class="component-contain draggableBox"
                  style="width: 120px; height: 15px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                Slider
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/17-singlebutton.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="Radio"
                  class="component-contain draggableBox"
                  style="width: 100px; height: 30px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                Radio
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/15-checkboxd.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="CheckBox"
                  class="component-contain draggableBox"
                  style="width: 100px; height: 30px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                CheckBox
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/20-parameter.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="ParameterBlock"
                  class="component-contain draggableBox"
                  style="width: 100px; height: 30px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                ParamBlock
              </div>
            </div>
          </div>
          <p class="title">Basic Modules</p>
          <div class="basic-modules-wrap flex-wrap">
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/4-button2.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="Button"
                  class="component-contain draggableBox"
                  style="width: 100px; height: 30px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                Button
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/3-button.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="PrimaryBtn"
                  class="component-contain draggableBox"
                  style="width: 100px; height: 30px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                Primary Btn
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/10-text-content.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="Label"
                  class="component-contain draggableBox"
                  style="width: 100px; height: 30px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                Label
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/11-text-subtitle.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="Title"
                  class="component-contain draggableBox"
                  style="width: 100px; height: 30px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                Title
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/12-text-headline.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="Subtitle"
                  class="component-contain draggableBox"
                  style="width: 100px; height: 30px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                Subtitle
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/6-input.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="Input"
                  class="component-contain draggableBox"
                  style="width: 217px; height: 40px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                Input
              </div>
            </div>
          </div>
          <p class="title">Navigation</p>
          <div class="navigation-wrap flex-wrap">
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/18-page.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="NavigationBar"
                  class="component-contain draggableBox"
                  style="width: 126px; height: 126px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                NavBar
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/21-tabbar.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="TabBar"
                  class="component-contain draggableBox"
                  style="width: 100px; height: 100px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                TabBar
              </div>
            </div>
            <div class="component-item">
              <div
                class="component-icon"
                style="
                  width: 50px;
                  height: 44px;
                  background: url('./framework/Assets/editor/22-choiceColumn.svg')
                    no-repeat center center;
                  background-size: contain;
                "
              >
                <div
                  id="ChoiceColumn"
                  class="component-contain draggableBox"
                  style="width: 500px; height: 100px; padding: 4px"
                >
                  <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
                </div>
              </div>
              <div
                style="
                  flex: 1;

                  font-size: 10px;
                  color: #7f8188;
                  text-align: center;
                  white-space: nowrap;
                "
              >
                ChoiceColumn
              </div>
            </div>
          </div>

          <!-- <div class="component-item">
            <div
              class="component-icon"
              style="
                flex: 1;
                width: 50px;
                height: 44px;
                background: url('./framework/Assets/editor/7-search.svg')
                  no-repeat center center;
                background-size: contain;
              "
            >
              <div
                id="Input-Search"
                class="component-contain draggableBox"
                style="width: 100px; height: 20px"
              >
                <div class="draggableBox-rightBottom"></div>
                <div class="draggableBox-leftTop"></div>
                <div class="draggableBox-rightTop"></div>
                <div class="draggableBox-leftBottom"></div>
                <div class="moveArea move"></div>
              </div>
            </div>
            <div style="flex: 1; overflow: hidden; font-size: 9px;color: #7F8188">Input</div>
          </div>
          <div class="component-item">
            <div
              class="component-icon"
              style="
                flex: 1;
                width: 50px;
                height: 44px;
                background: url('./framework/Assets/editor/8-input-default.svg')
                  no-repeat center center;
                background-size: contain;
              "
            >
              <div
                id="Input-Default"
                class="component-contain draggableBox"
                style="width: 100px; height: 30px"
              >
                <div class="draggableBox-rightBottom"></div>
                <div class="draggableBox-leftTop"></div>
                <div class="draggableBox-rightTop"></div>
                <div class="draggableBox-leftBottom"></div>
                <div class="moveArea move"></div>
              </div>
            </div>
            <div style="flex: 1; overflow: hidden; font-size: 9px;color: #7F8188">Input</div>
          </div>
          <div class="component-item">
            <div
              class="component-icon"
              style="
                flex: 1;
                width: 50px;
                height: 44px;
                background: url('./framework/Assets/editor/9-text-area.svg')
                  no-repeat center center;
                background-size: contain;
              "
            >
              <div
                id="Input-Default-IsTextarea"
                class="component-contain draggableBox"
                style="width: 100px; height: 50px"
              >
                <div class="draggableBox-rightBottom"></div>
                <div class="draggableBox-leftTop"></div>
                <div class="draggableBox-rightTop"></div>
                <div class="draggableBox-leftBottom"></div>
                <div class="moveArea move"></div>
              </div>
            </div>
            <div style="flex: 1; overflow: hidden; font-size: 9px;color: #7F8188">Input</div>
          </div> -->

          <!-- <div class="component-item">
            <div
              class="component-icon"
              style="
                flex: 1;
                width: 50px;
                height: 44px;
                background: url('./framework/Assets/editor/16-treesel.svg')
                  no-repeat center center;
                background-size: contain;
              "
            >
              <div
                id="TreeSelector"
                class="component-contain draggableBox"
                style="width: 100px; height: 50px"
              >
                <div class="draggableBox-rightBottom"></div>
                <div class="draggableBox-leftTop"></div>
                <div class="draggableBox-rightTop"></div>
                <div class="draggableBox-leftBottom"></div>
                <div class="moveArea move"></div>
              </div>
            </div>
            <div style="flex: 1; overflow: hidden; font-size: 9px;color: #7F8188">
              TreeSelector
            </div>
          </div> -->

          <!-- <div class="component-item">
            <div
              class="component-icon"
              style="
                flex: 1;
                width: 50px;
                height: 44px;
                background: url('./framework/Assets/editor/21-menu.svg')
                  no-repeat center center;
                background-size: contain;
              "
            >
              <div
                id="DropDownMenu"
                class="component-contain draggableBox"
                style="width: 100px; height: 30px"
              >
                <div class="draggableBox-rightBottom"></div>
                <div class="draggableBox-leftTop"></div>
                <div class="draggableBox-rightTop"></div>
                <div class="draggableBox-leftBottom"></div>
                <div class="moveArea move"></div>
              </div>
            </div>
            <div style="flex: 1; overflow: hidden; font-size: 9px;color: #7F8188">
              DropDownMenu
            </div>
          </div> -->
        </div>
      </div>

      <div class="preview-container">
        <div class="preview draggableBox showFlex" data-preview="1">
          <div class="draggableBox-rightBottom"></div>
          <div class="draggableBox-leftTop"></div>
          <div class="draggableBox-rightTop"></div>
          <div class="draggableBox-leftBottom"></div>
          <div class="windowBar">
            <div class="title">Demo1</div>
          </div>
          <div class="preview-content">
            <div class="offsetLeft"></div>
            <div class="offsetTop"></div>
          </div>
        </div>
        <div class="delete-container">
          <img
            src="./framework/Assets/editor/delete.svg"
            alt=""
            class="delete-icon"
          />
        </div>
      </div>
      <div class="wrapper parametersBar">
        <div class="parameters hideBlock">
          <div class="ele-title">
            <h4>name</h4>
            <img src="./framework/Assets/editor/ele-title-button.svg" alt="" />
            <input type="text" class="hideBlock dashedBox" />
          </div>

          <div>
            <div class="frame dashedBox">
              <div style="margin-bottom: 12px">
                <div>X</div>
                <input type="number" value="0" />
              </div>
              <div style="margin-bottom: 12px">
                <div>Y</div>
                <input type="number" value="0" />
              </div>
              <div>
                <div>W</div>
                <input type="number" value="0" />
              </div>
              <div>
                <div>H</div>
                <input type="number" value="0" />
              </div>
            </div>

            <div class="content dashedBox">
              <div id="group-259" class="inputBox">
                <input
                  type="text"
                  style="position: absolute; right: 0; z-index: 9"
                />
                <svg
                  class="rectangle-602"
                  width="80%"
                  height="100%"
                  viewBox="0 0 128 21"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M8.01369 5.25L9.61395 1.75L10.0687 1.95791L10.7353 0.5H12.4424V0H16.4989V0.5H20.5555V0H24.6121V0.5H28.6687V0H32.7252V0.5H36.7818V0H40.8384V0.5H44.8949V0H48.9515V0.5H53.0081V0H57.0647V0.5H61.1212V0H65.1778V0.5H69.2344V0H73.2909V0.5H77.3475V0H81.4041V0.5H85.4607V0H89.5172V0.5H93.5738V0H97.6304V0.5H101.687V0H105.744V0.5H109.8V0H113.857V0.5H117.913V0H121.97V0.5H123.998C124.474 0.5 124.926 0.594543 125.338 0.765386L125.529 0.303522C126.507 0.708984 127.289 1.49109 127.695 2.46885L127.233 2.66038C127.404 3.07236 127.498 3.52451 127.498 4V5.625H127.998V8.875H127.498V12.125H127.998V15.375H127.498V17C127.498 17.4755 127.404 17.9276 127.233 18.3396L127.695 18.5312C127.289 19.5089 126.507 20.291 125.529 20.6965L125.338 20.2346C124.926 20.4055 124.474 20.5 123.998 20.5H121.945V21H117.839V20.5H113.733V21H109.626V20.5H105.52V21H101.414V20.5H97.3079V21H93.2017V20.5H89.0955V21H84.9893V20.5H80.8831V21H76.7769V20.5H72.6708V21H68.5646V20.5H64.4584V21H60.3522V20.5H56.246V21H52.1398V20.5H48.0336V21H43.9275V20.5H39.8213V21H35.7151V20.5H31.6089V21H27.5027V20.5H23.3965V21H19.2903V20.5H15.1842V21H11.078V20.5H6.97178V21H2.86559V20.5H1.59089L2.06736 19.4579L1.61263 19.25L3.2129 15.75L3.66762 15.9579L5.26788 12.4579L4.81316 12.25L6.41342 8.75L6.86815 8.95791L8.46841 5.45791L8.01369 5.25Z"
                    stroke="#C4C6CA"
                    stroke-dasharray="4 4"
                  />
                </svg>

                <div class="frame-108">
                  <svg
                    class="rectangle-565"
                    width="52"
                    height="21"
                    viewBox="0 0 52 21"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M0 4C0 1.79086 1.79086 0 4 0H52L42.6016 21H4C1.79086 21 0 19.2091 0 17V4Z"
                      fill="#2A2D38"
                      fill-opacity="0.5"
                    />
                  </svg>

                  <svg
                    class="rectangle-562"
                    width="43"
                    height="21"
                    viewBox="0 0 43 21"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M0.5 4C0.5 2.067 2.067 0.5 4 0.5H41.7223L32.5975 20.5H4C2.067 20.5 0.5 18.933 0.5 17V4Z"
                      fill="#9D7FF5"
                      fill-opacity="0.15"
                      stroke="url(#paint0_linear_1232_27773)"
                    />
                    <defs>
                      <linearGradient
                        id="paint0_linear_1232_27773"
                        x1="25.1789"
                        y1="17.3907"
                        x2="-0.109264"
                        y2="9.06875"
                        gradientUnits="userSpaceOnUse"
                      >
                        <stop stop-color="#9D7FF5" />
                        <stop
                          offset="1"
                          stop-color="white"
                          stop-opacity="0.9"
                        />
                      </linearGradient>
                    </defs>
                  </svg>

                  <div class="ellipse-46"></div>
                  <div class="text">Text</div>
                  <div class="rectangle-564"></div>
                  <div class="ellipse-47"></div>
                </div>
              </div>
              <div class="placeholder-input">
                <input type="text" />
              </div>
              <div class="minimum-input">
                <input type="number" />
              </div>
              <div class="maximum-input">
                <input type="number" />
              </div>
              <div class="default-value-input">
                <input type="number" />
              </div>
              <div class="slider-step-input">
                <input type="number" />
              </div>

              <div class="label-choiceBox">
                <p>Label</p>
              </div>
              <div class="layout-choiceBox"></div>
              <div id="frame-325">
                <div class="rectangle-602"></div>
                <div class="rectangle-565"></div>
                <div class="rectangle-589"></div>
                <div class="line-25"></div>
                <div class="rectangle-5652"></div>
                <svg
                  class="ellipse-58"
                  width="43%"
                  height="83%"
                  viewBox="0 0 73 25"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M73 12.5C73 19.4036 56.6584 25 36.5 25C16.3416 25 0 19.4036 0 12.5C0 5.59644 16.3416 0 36.5 0C56.6584 0 73 5.59644 73 12.5Z"
                    fill="url(#paint0_radial_1232_27785)"
                  />
                  <defs>
                    <radialGradient
                      id="paint0_radial_1232_27785"
                      cx="0"
                      cy="0"
                      r="1"
                      gradientUnits="userSpaceOnUse"
                      gradientTransform="translate(34.4494 14.2442) rotate(97.2541) scale(9.74369 28.0122)"
                    >
                      <stop stop-color="#121212" stop-opacity="0.5" />
                      <stop offset="1" stop-color="#121212" stop-opacity="0" />
                    </radialGradient>
                  </defs>
                </svg>

                <svg
                  class="ellipse-582"
                  width="35%"
                  height="26%"
                  viewBox="0 0 59 8"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M59 4C59 6.20914 45.7924 8 29.5 8C13.2076 8 0 6.20914 0 4C0 1.79086 13.2076 0 29.5 0C45.7924 0 59 1.79086 59 4Z"
                    fill="url(#paint0_radial_1232_27786)"
                  />
                  <defs>
                    <radialGradient
                      id="paint0_radial_1232_27786"
                      cx="0"
                      cy="0"
                      r="1"
                      gradientUnits="userSpaceOnUse"
                      gradientTransform="translate(26.9714 4) rotate(90) scale(3.6 26.55)"
                    >
                      <stop stop-color="#9C81F2" stop-opacity="0.55" />
                      <stop
                        offset="0.0001"
                        stop-color="#9C81F2"
                        stop-opacity="0.13"
                      />
                      <stop offset="1" stop-color="#9C81F2" stop-opacity="0" />
                    </radialGradient>
                  </defs>
                </svg>

                <div class="font-size">Font-size</div>
                <div class="inputBox">
                  <input
                    type="text"
                    style="position: absolute; right: 0; z-index: 9"
                  />
                </div>
                <div class="px">px</div>
              </div>
              <p style="color: #7e828a; font-size: 12px; margin: 0 0 7px 0">
                Font-color
              </p>
              <div
                class="color-picker"
                style="width: 80%; height: 30px; font-size: 9px"
              ></div>
              <div class="loader-icon backgroundColor">
                <p>Loader-icon</p>
                <div class="icon-image-button"></div>
                <input
                  type="file"
                  class="theme-button-input"
                  style="display: none"
                />
                <div class="theme-fileName">
                  <img src="./framework/Assets/editor/imageIcon.svg" alt="" />
                  <div
                    style="
                      width: 125px;
                      white-space: break-spaces;
                      white-space: nowrap;
                      overflow: hidden;
                      text-overflow: ellipsis;
                    "
                  >
                    xxxxxx
                  </div>
                  <div class="theme-delete-button"></div>
                </div>
              </div>
              <div class="loader-background backgroundColor">
                <p>Loader-background</p>
                <div class="image-button"></div>
                <input
                  type="file"
                  class="theme-button-input"
                  style="display: none"
                />
                <div class="theme-fileName">
                  <img src="./framework/Assets/editor/imageIcon.svg" alt="" />
                  <div
                    style="
                      width: 125px;
                      white-space: break-spaces;
                      white-space: nowrap;
                      overflow: hidden;
                      text-overflow: ellipsis;
                    "
                  >
                    xxxxxx
                  </div>
                  <div class="theme-delete-button"></div>
                </div>
              </div>

              <div class="optionsList"></div>
            </div>
            <div class="other">
              <div class="attributes">
                <div class="item">
                  <div>
                    <input type="checkbox" id="inputId" />
                    <label for="inputId"></label>
                  </div>
                  <div>111111</div>
                </div>
                <div class="item">
                  <div>
                    <input type="checkbox" id="inputId2" />
                    <label for="inputId2"></label>
                  </div>
                  <div>111111</div>
                </div>
                <div class="item">
                  <div>
                    <input type="checkbox" id="inputId3" />
                    <label for="inputId3"></label>
                  </div>
                  <div>111111</div>
                </div>
                <div class="item">
                  <div>
                    <input type="checkbox" id="inputId4" />
                    <label for="inputId4"></label>
                  </div>
                  <div>111111</div>
                </div>
                <div class="item">
                  <div>
                    <input type="checkbox" id="inputId5" />
                    <label for="inputId5"></label>
                  </div>
                  <div>111111</div>
                </div>
              </div>
            </div>
          </div>

          <div class="add-item">
            <div class="add-item-button"></div>
          </div>

          <p style="font-size: 12px; color: rgba(255, 255, 255, 0.73)">
            Module Script
          </p>
          <div class="add-script">
            <div class="add-script-button"></div>
          </div>
        </div>
        <div class="imageParamsBar hideBlock">
          <p class="title text-background-clip">imageParamsBar</p>
          <div class="add-script">
            <div class="add-script-button"></div>
          </div>

          <div class="sd-button"></div>
        </div>
        <div class="windowParamsBar showBlock">
          <div class="system"></div>
          <div class="backgroundColor">
            <div>
              <p>Background-color</p>
            </div>
            <p>Background-Theme</p>
            <div class="theme-button"></div>
            <input
              type="file"
              class="theme-button-input"
              style="display: none"
            />
            <div class="theme-fileName">
              <img src="./framework/Assets/editor/imageIcon.svg" alt="" />
              <div
                style="
                  width: 125px;
                  white-space: break-spaces;
                  white-space: nowrap;
                  overflow: hidden;
                  text-overflow: ellipsis;
                "
              >
                xxxxxx
              </div>
              <div class="theme-delete-button"></div>
            </div>
          </div>
          APP Version
          <div class="script-editor-button"></div>
        </div>
      </div>
    </div>

    <script src="./framework/Laucher/Modules/sortablejs/Sortable.min.js"></script>
    <script src="./framework/Laucher/Modules/pickr/pickr.min.js"></script>
    <script src="./framework/Laucher/Modules/pickr/pickr.es5.min.js"></script>
    <!-- <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script> -->
    <script src="./framework/Laucher/Modules/tippy/tippy-core.js"></script>
    <script src="./framework/Laucher/Modules/tippy/tippy.js"></script>

    <script src="./framework/Laucher/Modules/html2canvas/html2canvas.min.js"></script>

    <script src="./framework/Laucher/Modules/codemirror/codemirror.min.js"></script>
    <script src="./framework/Laucher/Modules/codemirror/show-hint.min.js"></script>
    <script src="./framework/Laucher/Modules/codemirror/javascript.min.js"></script>
    <script src="./framework/Laucher/Modules/codemirror/autorefresh.min.js"></script>

    <script src="./framework/index.js"></script>

    <script src="UIEditor.js" type="module"></script>
    <script type="module">
      import ModifyBlock from "./framework/UI/SystemUI/ModifyBlock.js";
      import BookmarkPage from "./framework/UI/SystemUI/BookmarkPage.js";
      import SingleButton from "./framework/UI/SystemUI/SingleButton.js";

      const ModifyBlockElement = document.createElement("div");
      const tem = new ModifyBlock(ModifyBlockElement, {
        name: "ModifyBlock1",
        frame: {},
        attributes: {},
        content: {},
        style: {},
        actions: [],
      });
      tem.startDrawing("editor .parameters .content .color-picker");

      function renderAtr(data) {
        let atr = document.querySelector(".parameters .other .attributes");
        data.forEach((item, index) => {
          let tem = document.createElement("div");
          tem.classList.add("item");
          tem.innerHTML = `
                  <div>
                      <input type="checkbox" id="inputId${index}" />
                      <label for="inputId${index}"></label>
                  </div>
                  <div>${item}</div>
              `;
          atr.appendChild(tem);
        });
      }

      //
      const ModifyBlockElement2 = document.createElement("div");
      const tem2 = new ModifyBlock(ModifyBlockElement2, {
        name: "ModifyBlock2",
        frame: {},
        attributes: {},
        content: {},
        style: {},
        actions: [],
      });
      tem2.startDrawing(
        "editor .parametersBar .windowParamsBar .backgroundColor div:nth-of-type(1)"
      );

      const SystemBookmarkPageElement = document.createElement("div");
      const tem3 = new BookmarkPage(SystemBookmarkPageElement, {
        name: "system-BookmarkPage",
        frame: { width: "100%", height: "100%" },
        attributes: {},
        class: [],
        content: { list: ["Mac", "Windows", "Mobile"] },
        style: {},
        actions: [],
        script: [],
      });
      tem3.startDrawing(`editor .parametersBar .windowParamsBar .system`);

      const SingleButtonElement = document.createElement("div");
      const tem4 = new SingleButton(SingleButtonElement, {
        name: "VisibleLabel",
        frame: { width: "100%", height: "30px" },
        attributes: {},
        class: [],
        content: {
          list: ["Visible", "Hidden"],
        },
        style: {
          "justify-content": "flex-start",
        },
        actions: [],
        script: [],
      });
      tem4.startDrawing("editor .parameters .content .label-choiceBox");

      const SingleButtonElement2 = document.createElement("div");
      const tem5 = new SingleButton(SingleButtonElement2, {
        name: "LayoutLabel",
        frame: { width: "100%", height: "30px" },
        attributes: {},
        class: [],
        content: {
          list: ["H-Layout", "V-Layout"],
        },
        style: {
          "justify-content": "flex-start",
        },
        actions: [],
        script: [],
      });
      tem5.startDrawing("editor .parameters .content .layout-choiceBox");
    </script>
    <script type="module">
      import BaseView from "./framework/UI/SystemUI/BaseView.js";
      import Button from "./framework/UI/SystemUI/Button.js";
      import ImageUploader from "./framework/UI/SystemUI/ImageUploader.js"; // Assuming you have this class defined
      import Input from "./framework/UI/SystemUI/Input.js"; // Assuming you have this class defined
      import Text from "./framework/UI/SystemUI/Text.js";
      import ImageDisplay from "./framework/UI/SystemUI/ImageDisplay.js";
      import NavigationBar from "./framework/UI/SystemUI/NavigationBar.js";
      import CheckBox from "./framework/UI/SystemUI/CheckBox.js";
      import TreeSelector from "./framework/UI/SystemUI/TreeSelector.js";
      import SingleButton from "./framework/UI/SystemUI/SingleButton.js";
      import BookmarkPage from "./framework/UI/SystemUI/BookmarkPage.js";
      import Slider from "./framework/UI/SystemUI/Slider.js";
      import ParameterBlock from "./framework/UI/SystemUI/ParameterBlock.js";
      import DropDownMenu from "./framework/UI/SystemUI/DropDownMenu.js";
      import ModalWindow from "./framework/UI/SystemUI/ModalWindow.js";
      import ChoiceColumn from "./framework/UI/SystemUI/ChoiceColumn.js";
      import PopUps from "./framework/UI/SystemUI/PopUps.js";

      window.data = {};
      let textObj;
      let selectObj;
      let YObj;
      let WObj;
      let HObj;
      let colorObj;
      let tippyInstance;
      let tippyInstances = [];
      let attributes = [];
      let scriptList = [];
      let contentList = [];
      let backgroundImageList = [];
      let windowScript = "";
      window.data.choiceColumnList = [];
      let imageParamsScript = `{
        prompt:
          "sanachan, (masterpiece, top quality, best quality, official art, beautiful and aesthetic:1.2), (1girl:1.3), extremely detailed,(fractal art:1.1),(colorful:1.1)(flowers:1.3),highest detailed,(zentangle:1.2), (dynamic pose), (abstract background:1.3), (many colors:1.4), ,(earrings), (feathers:1.5)," +
          ans,
        batch_size: Number(outputNumber.value),

        negative_prompt:
          "(worst quality, low quality:2), nsfw, logo, signature, watermark, text, easynegative, (badhandv4), verybadimagenegative_v1.3, ng_deepnegative_v1_75t",

        hr_resize_x: 512,

        hr_resize_y: 768,

        width: 512,

        height: 768,

        cfg_scale: 6.5,

        seed: 3678817358,

        sampler_name: "DPM++ 2M Karras",

        n_iter: 1,

        denoising_strength: 0.55,

        enable_hr: true,

        hr_scale: 2,

        hr_upscaler: "R-ESRGAN 4x+ Anime6B",

        hr_second_pass_steps: 15,
      }`;
      var manifest = {
        appname: "demo",
        version: "1.0.0",
        icon: "",
        platform: "",
        company: "",
        license: "",
        description:
          "You can use this tool to remove the background of the image",
        update: "",
        history: "",
      };
      let indexData = {
        VStack: 1,
        HStack: 1,
        Button: 1,
        PrimaryBtn: 1,
        Label: 1,
        Title: 1,
        Subtitle: 1,
        Input: 1,
        ImgLoader: 1,
        ImgViewer: 1,
        ImgCanvas: 1,
        Image: 1,
        TabBar: 1,
        Radio: 1,
        // "Button": 1,
        // "PrimaryBtn": 1,
        // ImageUploader: 1,
        // "Input-Input": 1,
        // "Input-Search": 1,
        // "Input-Default": 1,
        // "Input-Default-IsTextarea": 1,
        // "Text-TextContent": 1,
        // "Text-Subtitle": 1,
        // "Text-Headline": 1,
        // ImageDisplay: 1,
        NavigationBar: 1,
        CheckBox: 1,
        TreeSelector: 1,
        // SingleButton: 1,
        // BookmarkPage: 1,
        Slider: 1,
        ParameterBlock: 1,
        DropDownMenu: 1,
        ModalWindow: 1,
        PromptInforma: 1,
        ChoiceColumn: 1,
      };

      document
        .querySelectorAll("#editor .components .component-item")
        .forEach((item) => {
          new Sortable(item.querySelector(".component-icon"), {
            group: {
              name: "shared",
              pull: "clone", // To clone: set pull to 'clone'
              put: false,
            },
            sort: false,
            animation: 150,
            forceFallback: true,
            dragClass: "drag",

            onClone: function (evt) {
              let origEl = evt.item;
              let cloneEl = evt.clone;

              if (origEl == cloneEl) {
                // console.log("true");
              } else {
                // console.log("false");
              }

              hideOffsetLine();

              //   console.log("origEl", origEl, "cloneEl", cloneEl);

              const draggable = document.querySelectorAll(".draggableBox");

              draggable.forEach((item) => {
                let resizing = false;
                let position;
                let initialX, initialY, initialWidth, initialHeight;

                item.addEventListener("mousedown", (e) => {
                  e.stopPropagation();

                  if (e.target.classList.contains("draggableBox-rightBottom")) {
                    console.log("rightBottom");
                    position = "rightBottom";
                    resizing = true;
                    initialX = e.clientX;
                    initialY = e.clientY;
                    initialWidth = item.offsetWidth;
                    initialHeight = item.offsetHeight;
                  }
                  if (e.target.classList.contains("draggableBox-leftTop")) {
                    console.log("leftTop");
                    position = "leftTop";
                    resizing = true;
                    initialX = e.clientX;
                    initialY = e.clientY;
                    initialWidth = item.offsetWidth;
                    initialHeight = item.offsetHeight;
                  }
                  if (e.target.classList.contains("draggableBox-rightTop")) {
                    console.log("rightTop");
                    position = "rightTop";
                    resizing = true;
                    initialX = e.clientX;
                    initialY = e.clientY;
                    initialWidth = item.offsetWidth;
                    initialHeight = item.offsetHeight;
                  }
                  if (e.target.classList.contains("draggableBox-leftBottom")) {
                    console.log("leftBottom");
                    position = "leftBottom";
                    resizing = true;
                    initialX = e.clientX;
                    initialY = e.clientY;
                    initialWidth = item.offsetWidth;
                    initialHeight = item.offsetHeight;
                  }
                });
                document.addEventListener("mousemove", (e) => {
                  if (resizing) {
                    let deltaX;
                    let deltaY;
                    if (position === "rightBottom") {
                      deltaX = e.clientX - initialX;
                      deltaY = e.clientY - initialY;
                    } else if (position === "leftTop") {
                      deltaX = initialX - e.clientX;
                      deltaY = initialY - e.clientY;
                    } else if (position === "rightTop") {
                      deltaX = e.clientX - initialX;
                      deltaY = initialY - e.clientY;
                    } else if (position === "leftBottom") {
                      deltaX = initialX - e.clientX;
                      deltaY = e.clientY - initialY;
                    }

                    hideTippy();

                    const newWidth = initialWidth + deltaX;
                    const newHeight = initialHeight + deltaY;

                    item.style.width = newWidth + "px";
                    item.style.height = newHeight + "px";
                    // hideOffsetLine();

                    if (!item.classList.contains("preview")) {
                      showOffsetLine(item);
                    }
                    tippyInstance.hide();
                  }
                });

                document.addEventListener(
                  "mouseup",
                  () => {
                    console.log("mouseup");
                    if (resizing) {
                      resizing = false;
                    }
                  },
                  true
                );
              });
            },
            onSort: function (evt) {
              console.log("onSort", evt.item);

              let nestedSortables = document.querySelectorAll(
                ".preview .draggable"
              );

              for (var i = 0; i < nestedSortables.length; i++) {
                new Sortable(nestedSortables[i], {
                  animation: 150,
                  fallbackOnBody: true,
                  swapThreshold: 0.65,
                  forceFallback: true,
                  group: {
                    name: "nested",
                    put: true, // 允许从其他容器拖拽放置到此容器
                  },
                  draggable: ".component-contain",
                  handle: ".move",
                  dragClass: "dragMove",
                  onStart: function (evt) {
                    console.log("2onStart");
                    hideOffsetLine();
                    hideTippy();
                  },
                  onEnd: function (evt) {
                    console.log("2end");
                  },
                  onAdd: function (evt) {
                    console.log("2add", evt);
                    if (
                      evt.item.classList.contains("draggableBox") &&
                      !hasTippyInstance(evt.item)
                    ) {
                      tippyInstance = tippy(evt.item, {
                        placement: "bottom",
                        trigger: "click",
                        onShow(instance) {
                          // 在工具提示显示时更新内容
                          const width = origEl.clientWidth; // 获取元素的宽度
                          const height = origEl.clientHeight; // 获取元素的高度
                          instance.setContent(`${width - 8} x ${height - 8}`);
                        },
                      });
                      tippyInstances.push(tippyInstance);
                      console.log("2tippyInstances");
                      //               setTimeout(() => {
                      //                 console.log("reference", tippyInstance.reference.id);
                      //                 scriptList.push({
                      //                   name: tippyInstance.reference.id,
                      //                   content: `function helloWorld() {
                      //   console.log(' Hello, ${tippyInstance.reference.id}!');
                      // }`,
                      //                 });
                      //               }, 10);
                    }

                    hideOffsetLine();
                    let origEl = evt.item;
                    //   console.log("add", origEl, evt, origEl.firstElementChild);
                    if (origEl.classList.contains("draggableBox")) {
                      origEl.removeEventListener("click", getComponentAtr);
                      origEl.addEventListener("click", getComponentAtr);
                    }
                    for (const property in indexData) {
                      // 获取原始对象的id
                      var originalId = evt.item.id;

                      // 将克隆后的对象的id设置为原始对象id加一
                      if (property == originalId) {
                        var cloneId = originalId + `_${indexData[property]}`;
                        // 设置克隆后的对象的id
                        evt.clone.id = evt.item.id;
                        evt.item.id = cloneId.toString();

                        if (property.includes("-")) {
                          switch (property.split("-")[0]) {
                            case "Button":
                              break;
                            case "Text":
                              break;
                            case "Input":
                              break;
                          }
                        } else {
                          let tem;
                          switch (property) {
                            case "VStack":
                              break;
                            case "HStack":
                              break;
                            case "ImgLoader":
                              attributes.push({
                                id: evt.item.id,
                                content: [
                                  { name: "isCanvas", state: false },
                                  { name: "isPens", state: false },
                                  { name: "isImgCompare", state: false },
                                ],
                              });
                              console.log("attributes", attributes);
                              break;
                            case "ImgViewer":
                              break;
                            case "NavigationBar":
                              tem = new NavigationBar(
                                document.createElement("div"),
                                {}
                              );
                              tem.renderingStyle(evt.item, evt.item.id);
                              break;
                            case "CheckBox":
                              console.log(evt.item, evt.item.id, evt.clone);
                              tem = new CheckBox(
                                document.createElement("div"),
                                {}
                              );
                              tem.renderingStyle(evt.item, evt.item.id);
                              break;
                            case "TreeSelector":
                              tem = new TreeSelector(
                                document.createElement("div"),
                                {}
                              );
                              tem.renderingStyle(evt.item, evt.item.id);
                              break;
                            case "Radio":
                              tem = new SingleButton(
                                document.createElement("div"),
                                {}
                              );
                              tem.renderingStyle(evt.item, evt.item.id);
                              break;
                            case "TabBar":
                              tem = new BookmarkPage(
                                document.createElement("div"),
                                {}
                              );
                              tem.renderingStyle(evt.item, evt.item.id);
                              break;
                            case "ChoiceColumn":
                              tem = new ChoiceColumn(
                                document.createElement("div"),
                                {}
                              );
                              tem.renderingStyle(evt.item, evt.item.id);
                              break;
                            case "Slider":
                              tem = new Slider(
                                document.createElement("div"),
                                {}
                              );
                              tem.renderingStyle(evt.item, evt.item.id);
                              break;
                            case "ParameterBlock":
                              break;
                            case "DropDownMenu":
                              tem = new DropDownMenu(
                                document.createElement("div"),
                                {}
                              );
                              tem.renderingStyle(evt.item, evt.item.id);
                              break;
                            case "ModalWindow":
                              break;
                            case "PromptInforma":
                              break;
                          }
                        }

                        indexData[property] += 1;
                      }
                    }

                    //
                    let previewComponents = document.querySelectorAll(
                      ".preview .draggableBox "
                    );

                    function getComponentAtr() {
                      event.stopPropagation();
                      console.log("getComponentAtr", origEl);

                      hideOffsetLine();

                      showOffsetLine(origEl);

                      if (
                        origEl.lastElementChild.id === "ImgLoader" ||
                        origEl.lastElementChild.id === "ImgViewer"
                      ) {
                        document.querySelector(
                          ".parametersBar .parameters .attributes"
                        ).style.display = "flex";
                        document.querySelector(
                          ".parametersBar .parameters .other >div:nth-of-type(1)"
                        ).style.display = "flex";
                        document.querySelector(
                          ".parametersBar .parameters .content .loader-icon"
                        ).style.display = "block";
                        document.querySelector(
                          ".parametersBar .parameters .content .loader-background"
                        ).style.display = "block";
                      } else {
                        document.querySelector(
                          ".parametersBar .parameters .attributes"
                        ).style.display = "none";
                        document.querySelector(
                          ".parametersBar .parameters .other >div:nth-of-type(1)"
                        ).style.display = "none";
                        document.querySelector(
                          ".parametersBar .parameters .content .loader-icon"
                        ).style.display = "none";
                        document.querySelector(
                          ".parametersBar .parameters .content .loader-background"
                        ).style.display = "none";
                      }

                      /** parametersBar show */
                      document
                        .querySelectorAll(".parametersBar >div")
                        .forEach((item) => {
                          if (item.classList.contains("parameters")) {
                            item.classList.remove("hideBlock");
                            item.classList.add("showBlock");
                          } else {
                            item.classList.remove("showBlock");
                            item.classList.add("hideBlock");
                          }
                        });
                      /** parametersBar show */

                      document.querySelectorAll(
                        ".preview.showFlex"
                      )[0].style.border = "none";
                      document
                        .querySelectorAll(".preview.showFlex")[0]
                        .classList.remove("showAfter");

                      origEl.style.border = "solid 2px #0f81e6";
                      origEl.classList.add("showAfter");

                      let ele;
                      if (origEl.id.includes("_")) {
                        ele = origEl.id.split("_")[0];
                      } else {
                        ele = origEl.id;
                      }
                      let parameters = document.querySelector(
                        "#editor .parameters"
                      );
                      textObj = origEl.lastElementChild;
                      selectObj = origEl;
                      window.data.selectObj = selectObj;

                      switch (ele) {
                        case "PrimaryBtn":
                          textObj = origEl.querySelector(".button-text");
                          break;
                        case "Button":
                          textObj = origEl.querySelector(".button-text");
                          break;
                        case "Input":
                          textObj = origEl.querySelector(".input-text");
                          document.querySelector(
                            ".parameters .content .placeholder-input input"
                          ).placeholder =
                            origEl.querySelector("input").placeholder;
                          break;

                        case "Slider":
                          document.querySelector(
                            ".parameters .content .minimum-input input"
                          ).value = origEl.querySelector("input").min;
                          document.querySelector(
                            ".parameters .content .maximum-input input"
                          ).value = origEl.querySelector("input").max;
                          document.querySelector(
                            ".parameters .content .default-value-input input"
                          ).value = origEl.querySelector("input").value;
                          document.querySelector(
                            ".parameters .content .slider-step-input input"
                          ).value = origEl.querySelector("input").step;
                          break;

                        case "CheckBox":
                          textObj = origEl.querySelector(".checkbox-text");
                          break;
                        case "ParameterBlock":
                          textObj = origEl.querySelector(
                            ".parameterBlock-text"
                          );
                          break;
                        case "NavigationBar":
                          watchChoiceBox(".layout-choiceBox");
                          break;
                        case "TabBar":
                          textObj = origEl.querySelector(".tabs");
                          break;
                        case "ChoiceColumn":
                          window.data.choiceColumnList = [];
                          document
                            .querySelectorAll(
                              `#${selectObj.id} .container-item`
                            )
                            .forEach((item, index) => {
                              const regex = /url\("(.*?)"/;
                              const match =
                                item.firstElementChild.style.background.match(
                                  regex
                                );

                              // 提取匹配到的URL
                              if (match) {
                                const url = match[1];
                                window.data.choiceColumnList.push({
                                  url: url,
                                  name: selectObj.id,
                                  title: item.querySelector("p").innerText,
                                  active: false,
                                });
                              }
                            });
                          break;
                        case "ImgLoader":
                          textObj = origEl.querySelector(".imageUploader-text");

                          if (
                            !origEl
                              .querySelector(".imageUploader-icon")
                              .src.includes("/framework/Assets/uploadCloud.svg")
                          ) {
                            document
                              .querySelector(
                                ".parameters .loader-icon  .theme-fileName"
                              )
                              .querySelector("div:nth-of-type(1)").innerText =
                              origEl
                                .querySelector(".imageUploader-icon")
                                .src.split("/")
                                .pop();
                            document.querySelector(
                              ".parameters .loader-icon  .theme-fileName"
                            ).style.display = "flex";
                            document.querySelector(
                              ".parameters .icon-image-button"
                            ).style.display = "none";
                          } else {
                            document.querySelector(
                              ".parameters .loader-icon  .theme-fileName"
                            ).style.display = "none";
                            document.querySelector(
                              ".parameters .icon-image-button"
                            ).style.display = "block";
                          }
                          if (
                            origEl.querySelector(".imageUploader-input-contain")
                              .style.background
                          ) {
                            document
                              .querySelector(
                                ".parameters .loader-background  .theme-fileName"
                              )
                              .querySelector("div:nth-of-type(1)").innerText =
                              origEl
                                .querySelector(".imageUploader-input-contain")
                                .style.background.split("/")
                                .pop();
                            document.querySelector(
                              ".parameters .loader-background  .theme-fileName"
                            ).style.display = "flex";
                            document.querySelector(
                              ".parameters .image-button"
                            ).style.display = "none";
                          } else {
                            document.querySelector(
                              ".parameters .loader-background  .theme-fileName"
                            ).style.display = "none";
                            document.querySelector(
                              ".parameters .image-button"
                            ).style.display = "block";
                          }
                          break;
                        case "Image":
                          if (
                            !origEl.lastElementChild.style.background.includes(
                              "/framework/Assets/editor/image-background.svg"
                            )
                          ) {
                            document
                              .querySelector(
                                ".parameters .loader-background  .theme-fileName"
                              )
                              .querySelector("div:nth-of-type(1)").innerText =
                              origEl.lastElementChild.style.background
                                .split("/")
                                .pop();
                            document.querySelector(
                              ".parameters .loader-background  .theme-fileName"
                            ).style.display = "flex";
                            document.querySelector(
                              ".parameters .image-button"
                            ).style.display = "none";
                          } else {
                            document.querySelector(
                              ".parameters .loader-background  .theme-fileName"
                            ).style.display = "none";
                            document.querySelector(
                              ".parameters .image-button"
                            ).style.display = "block";
                          }
                          break;
                        case "Button":
                          textObj = origEl.querySelector(".button-text");
                          break;
                        case "PrimaryBtn":
                          textObj = origEl.querySelector(".button-text");
                          break;
                      }

                      showModuleScript();
                      showItemList();
                      /** 修改preview 颜色块显示颜色*/

                      if (textObj.id === "Radio") {
                        document.querySelector(
                          "#editor .parameters .content .color-picker .picker-input input"
                        ).value = rgbaToHexAndAlpha(
                          textObj.querySelector(".custom-radio").style.color
                        )[0];
                        document.querySelector(
                          "#editor .parameters .content .color-picker .picker-opacity input"
                        ).value = rgbaToHexAndAlpha(
                          textObj.querySelector(".custom-radio").style.color
                        )[1];
                      } else if (textObj.id === "TreeSelector") {
                        document.querySelector(
                          "#editor .parameters .content .color-picker .picker-input input"
                        ).value = rgbaToHexAndAlpha(
                          textObj.querySelector(".tree-checkbox-text").style
                            .color
                        )[0];
                        document.querySelector(
                          "#editor .parameters .content .color-picker .picker-opacity input"
                        ).value = rgbaToHexAndAlpha(
                          textObj.querySelector(".tree-checkbox-text").style
                            .color
                        )[1];
                      } else if (textObj.id === "DropDownMenu") {
                        document.querySelector(
                          "#editor .parameters .content .color-picker .picker-input input"
                        ).value = rgbaToHexAndAlpha(
                          textObj.querySelector(".title").style.color
                        )[0];
                        document.querySelector(
                          "#editor .parameters .content .color-picker .picker-opacity input"
                        ).value = rgbaToHexAndAlpha(
                          textObj.querySelector(".title").style.color
                        )[1];
                      } else {
                        document.querySelector(
                          "#editor .parameters .content .color-picker .picker-input input"
                        ).value = rgbaToHexAndAlpha(textObj.style.color)[0];
                        document.querySelector(
                          "#editor .parameters .content .color-picker .picker-opacity input"
                        ).value = rgbaToHexAndAlpha(textObj.style.color)[1];
                      }

                      /** 修改preview 颜色块显示颜色*/

                      parameters.querySelector(".ele-title h4").innerText =
                        origEl.id;

                      if (attributes.length !== 0) {
                        let attributesEle = document.querySelector(
                          "#editor .parameters .attributes"
                        );

                        let contentHTML = ""; // 用于存储 content 内容的HTML

                        attributes.forEach((item) => {
                          if (item.id === origEl.id) {
                            contentHTML = item.content
                              .map((item2) => {
                                return `<div class="${item2.name}-item item">
                  <div>
                    <input type="checkbox" id="inputId-${item2.name}" ${
                                  item2.state ? "checked" : ""
                                } />
                    <label for="inputId-${item2.name}"></label>
                  </div>


                </div>`;
                              })
                              .join("");
                          }
                        });

                        attributesEle.innerHTML = `
                      ${contentHTML}
                      `;
                        attributesEle
                          .querySelectorAll(".item input[type='checkbox']")
                          .forEach((item, index) => {
                            item.addEventListener("change", () => {
                              attributes.forEach((item) => {
                                if (item.id === origEl.id) {
                                  item.content.forEach((item2, index2) => {
                                    if (index === index2) {
                                      item2.state = event.target.checked;
                                      let atr = event.target.id.split("-")[1];
                                      console.log(
                                        "event.target.checked",
                                        event.target.checked
                                      );

                                      const imageUploaderElement =
                                        document.createElement("div");
                                      let tem;
                                      switch (atr) {
                                        case "isCanvas":
                                          if (event.target.checked) {
                                            document
                                              .querySelector(
                                                `#editor .preview #${selectObj.id} `
                                              )
                                              .setAttribute("isCanvas", "true");
                                            document.querySelector(
                                              `#editor .preview #${selectObj.id} `
                                            ).innerHTML = `
              <canvas class="tool-canvas" width= "100%" height= "100%" style=" border-radius: 8px; background-color: #fff;width: 100%;height: 100%;" >
              </canvas>
          <div class="mouse" style="left: 0;top: 0;position: absolute;width: 16px;height:16px; background: url('./framework/Assets/pens.svg') no-repeat center center /cover; display: none;"></div>
          <div style="display: flex;justify-content: space-between">
            <div id="eraserButton" style="cursor: pointer;width: 20px;height: 20px; background: url('./framework/Assets/eraserButton.svg') no-repeat center center / cover"></div>
            <div id="penButton" style="cursor: pointer;width: 20px;height: 20px; background: url('./framework/Assets/penButton.svg') no-repeat center center / cover"></div>
            <div id="clearCanvasBtn" style="cursor: pointer;width: 20px;height: 20px; background: url('./framework/Assets/clearCanvasBtn.svg') no-repeat center center / cover"></div>
            <div id="backCanvasBtn" style="cursor: pointer;width: 20px;height: 20px; background: url('./framework/Assets/backCanvasBtn.svg') no-repeat center center / cover"></div>
          </div>
                                          `;
                                          } else {
                                            tem = new ImageUploader(
                                              imageUploaderElement,
                                              {
                                                name: "ImgLoader",
                                                frame: {
                                                  width: "100%",
                                                  height: "100%",
                                                },
                                                attributes: {},
                                                class: [],
                                                content: {},
                                                style: {},
                                                actions: [],
                                                scripts: [],
                                              }
                                            );
                                            document
                                              .querySelector(
                                                `#editor .preview #${selectObj.id} `
                                              )
                                              .removeAttribute("isCanvas");
                                            document.querySelector(
                                              `#editor .preview #${selectObj.id} `
                                            ).innerHTML = "";
                                            tem.startDrawing(
                                              `editor .preview #${selectObj.id} `
                                            );
                                          }

                                          break;
                                        case "isPens":
                                          if (event.target.checked) {
                                            document
                                              .querySelector(
                                                `#editor .preview #${selectObj.id} `
                                              )
                                              .setAttribute("isPens", "true");
                                            document.querySelector(
                                              `#editor .preview #${selectObj.id} `
                                            ).innerHTML = `
                                            <div class="draggableBox-rightBottom"></div>
                                            <div class="draggableBox-leftTop"></div>
                                            <div class="draggableBox-rightTop"></div>
                                            <div class="draggableBox-leftBottom"></div>
                                            <div class="moveArea move"></div>
                                          `;
                                            tem = new ImageUploader(
                                              imageUploaderElement,
                                              {
                                                name: "ImgLoader",
                                                frame: {
                                                  width: "100%",
                                                  height: "100%",
                                                },
                                                attributes: {
                                                  isPens: "true",
                                                },
                                                class: [],
                                                content: {},
                                                style: {},
                                                actions: [],
                                                scripts: [],
                                              }
                                            );

                                            tem.startDrawing(
                                              `editor .preview #${selectObj.id} `
                                            );
                                          } else {
                                            tem = new ImageUploader(
                                              imageUploaderElement,
                                              {
                                                name: "ImgLoader",
                                                frame: {
                                                  width: "100%",
                                                  height: "100%",
                                                },
                                                attributes: {},
                                                class: [],
                                                content: {},
                                                style: {},
                                                actions: [],
                                                scripts: [],
                                              }
                                            );
                                            document
                                              .querySelector(
                                                `#editor .preview #${selectObj.id} `
                                              )
                                              .removeAttribute("isPens");
                                            document.querySelector(
                                              `#editor .preview #${selectObj.id} `
                                            ).innerHTML = `
                                            <div class="draggableBox-rightBottom"></div>
                                            <div class="draggableBox-leftTop"></div>
                                            <div class="draggableBox-rightTop"></div>
                                            <div class="draggableBox-leftBottom"></div>
                                            <div class="moveArea move"></div>
                                            `;
                                            tem.startDrawing(
                                              `editor .preview #${selectObj.id} `
                                            );
                                          }
                                          break;
                                        case "isImgCompare":
                                          break;
                                        default:
                                          break;
                                      }
                                    }
                                  });
                                }
                              });
                            });
                          });
                      }

                      parameters.querySelector(
                        ".frame  div:nth-of-type(1) input"
                      ).value = origEl.style.marginLeft.split("px")[0]
                        ? origEl.style.marginLeft.split("px")[0]
                        : 0;
                      parameters.querySelector(
                        ".frame  div:nth-of-type(2) input"
                      ).value = origEl.style.marginTop.split("px")[0]
                        ? origEl.style.marginTop.split("px")[0]
                        : 0;
                      parameters.querySelector(
                        ".frame  div:nth-of-type(3) input"
                      ).value = origEl.style.width.split("px")[0];
                      parameters.querySelector(
                        ".frame  div:nth-of-type(4) input"
                      ).value = origEl.style.height.split("px")[0];

                      if (textObj) {
                        parameters.querySelector(".content ").style.display =
                          "block";
                        if (
                          ele === "TreeSelector" ||
                          ele === "Radio" ||
                          ele === "DropDownMenu" ||
                          ele === "TabBar" ||
                          ele === "NavigationBar"
                        ) {
                          // 使用换行符分割文本内容成多个行
                          let lines = textObj.innerText.split("\n");

                          // 创建一个空数组来存储结果
                          let result = [];

                          // 遍历每一行文本，去除首尾空白字符，然后添加到结果数组中
                          for (let i = 0; i < lines.length; i++) {
                            let line = lines[i].trim();
                            if (line.length > 0) {
                              result.push(line);
                            }
                          }

                          let contentHTML = ""; // 用于存储 content 内容的HTML
                          let number, name;

                          if (ele === "Radio") {
                            name = "Option";
                          }
                          if (ele === "TabBar") {
                            name = "Tab";
                          }
                          if (ele === "NavigationBar") {
                            name = "Item";

                            contentHTML = result
                              .map((item, index) => {
                                number = index + 1;
                                return `
                        <div style="width: 100%; height: 21px; display: flex;  margin-top: 15px; margin-bottom: 10px;">
                        <div class="navBar-item-input">
                          <div class="title">${name}${number}</div>
                          <input type="text" value='${item}' />
                        </div>
                        <img class="editor-button" style="margin: 0 3px;width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-editor.svg">
                        <img class="delete-button" style="width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-delete.svg">
                        </div>     
                        `;
                              })
                              .join("");
                            contentHTML += `
                  <div class="button-none">
                    + Add Option
                    </div>

                    `;

                            parameters.querySelector(
                              ".content  .optionsList"
                            ).innerHTML = `${contentHTML}`;

                            parameters
                              .querySelector(
                                ".content  .optionsList .button-none"
                              )
                              .addEventListener("click", () => {
                                number++;
                                let optionItem = document.createElement("div");
                                optionItem.style.cssText = `
width: 100%; height: 21px; display: flex;  margin-top: 15px; margin-bottom: 10px;
`;
                                optionItem.innerHTML = `
                        
                        <div class="navBar-item-input">
                          <div class="title">${name}${number}</div>
                          <input type="text" value='xx' />
                        </div>
                        <img class="editor-button" style="margin: 0 3px;width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-editor.svg">
                        <img class="delete-button" style="width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-delete.svg">
                        
                      `;

                                // 获取当前点击元素的父元素
                                let parentElement = event.target.parentElement;

                                // 获取当前点击元素在父元素子节点中的位置
                                let currentIndex = Array.from(
                                  parentElement.children
                                ).indexOf(event.target);

                                // 使用 insertBefore 方法将新元素插入到当前点击元素的前一个位置
                                parentElement.insertBefore(
                                  optionItem,
                                  parentElement.children[currentIndex]
                                );
                                handleContent();
                              });
                          } else {
                            contentHTML = result
                              .map((item, index) => {
                                number = index + 1;
                                return `
                        <div style="width: 100%; height: 21px; display: flex;  margin-top: 15px; margin-bottom: 10px;">
                        <div class="navBar-item-input">
                          <div class="title">${name}${number}</div>
                          <input type="text" value='${item}' />
                        </div>
                        <img class="delete-button" style="width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-delete.svg">
                        </div>  
                                 
  
                                `;
                              })
                              .join("");
                            contentHTML += `
                  <div class="button-none">
                    + Add Option
                    </div>

                    `;

                            parameters.querySelector(
                              ".content  .optionsList"
                            ).innerHTML = `${contentHTML}`;

                            parameters
                              .querySelector(
                                ".content  .optionsList .button-none"
                              )
                              .addEventListener("click", () => {
                                number++;
                                let optionItem = document.createElement("div");
                                optionItem.style.cssText = `
width: 100%; height: 21px; display: flex;  margin-top: 15px; margin-bottom: 10px;
`;
                                optionItem.innerHTML = `
                       
                        <div class="navBar-item-input">
                          <div class="title">${name}${number}</div>
                          <input type="text" value='xx' />
                        </div>
                        <img class="delete-button" style="width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-delete.svg">
                         
                      `;

                                // 获取当前点击元素的父元素
                                let parentElement = event.target.parentElement;

                                // 获取当前点击元素在父元素子节点中的位置
                                let currentIndex = Array.from(
                                  parentElement.children
                                ).indexOf(event.target);

                                // 使用 insertBefore 方法将新元素插入到当前点击元素的前一个位置
                                parentElement.insertBefore(
                                  optionItem,
                                  parentElement.children[currentIndex]
                                );
                                handleContent();
                              });
                          }
                          handleContent();
                        } else {
                          parameters.querySelector(
                            ".content  .inputBox input"
                          ).value = textObj.innerText;
                        }
                      } else {
                        parameters.querySelector(".content ").style.display =
                          "none";
                      }
                    }
                  },
                });
              }

              //
            },
            onEnd: function (evt) {
              console.log("end");
            },
            onMove: function (evt) {
              //   setTimeout(() => {
              //     console.log(
              //       "onMove",
              //       document.querySelectorAll(".preview.showFlex")[0].innerHTML
              //     );
              //   }, 0);
              let origEl = evt.dragged;
            },
          });
        });

      new Sortable(
        document.querySelectorAll(".preview.showFlex .preview-content")[0],
        {
          group: {
            name: "nested",
            put: true, // 允许从其他容器拖拽放置到此容器
          },
          animation: 150,
          forceFallback: true,

          // draggable: ".draggableBox",
          draggable: ".component-contain",
          handle: ".move",
          dragClass: "dragMove",
          onStart: function (evt) {
            hideOffsetLine();
            hideTippy();
          },
          onEnd: function (evt) {},

          onAdd: function (evt) {
            console.log("1add");
            if (
              evt.item.classList.contains("draggableBox") &&
              !hasTippyInstance(evt.item)
            ) {
              tippyInstance = tippy(evt.item, {
                placement: "bottom",
                trigger: "click",
                onShow(instance) {
                  // 在工具提示显示时更新内容
                  const width = origEl.clientWidth; // 获取元素的宽度
                  const height = origEl.clientHeight; // 获取元素的高度
                  instance.setContent(`${width - 8} x ${height - 8}`);
                },
              });
              tippyInstances.push(tippyInstance);
              console.log("1tippyInstances");
              //       setTimeout(() => {
              //         console.log("reference", tippyInstance.reference.id);
              //         scriptList.push({
              //           name: tippyInstance.reference.id,
              //           content: `function helloWorld() {
              //   console.log(' Hello, ${tippyInstance.reference.id}!');
              // }`,
              //         });
              //       }, 10);
            }

            hideOffsetLine();
            let origEl = evt.item;
            //   console.log("add", origEl, evt, origEl.firstElementChild);
            if (origEl.classList.contains("draggableBox")) {
              origEl.removeEventListener("click", getComponentAtr);
              origEl.addEventListener("click", getComponentAtr);
            }
            for (const property in indexData) {
              // 获取原始对象的id
              var originalId = evt.item.id;

              // 将克隆后的对象的id设置为原始对象id加一
              if (property == originalId) {
                var cloneId = originalId + `_${indexData[property]}`;
                // 设置克隆后的对象的id
                evt.clone.id = evt.item.id;
                evt.item.id = cloneId.toString();

                if (property.includes("-")) {
                  switch (property.split("-")[0]) {
                    case "Button":
                      break;
                    case "Text":
                      break;
                    case "Input":
                      break;
                  }
                } else {
                  let tem;
                  switch (property) {
                    case "VStack":
                      break;
                    case "HStack":
                      break;
                    case "ImgLoader":
                      attributes.push({
                        id: evt.item.id,
                        content: [
                          { name: "isCanvas", state: false },
                          { name: "isPens", state: false },
                          { name: "isImgCompare", state: false },
                        ],
                      });
                      console.log("attributes", attributes);
                      break;
                    case "ImgViewer":
                      break;
                    case "NavigationBar":
                      tem = new NavigationBar(
                        document.createElement("div"),
                        {}
                      );
                      tem.renderingStyle(evt.item, evt.item.id);
                      break;
                    case "CheckBox":
                      console.log(evt.item, evt.item.id, evt.clone);
                      tem = new CheckBox(document.createElement("div"), {});
                      tem.renderingStyle(evt.item, evt.item.id);
                      break;
                    case "TreeSelector":
                      tem = new TreeSelector(document.createElement("div"), {});
                      tem.renderingStyle(evt.item, evt.item.id);
                      break;
                    case "Radio":
                      tem = new SingleButton(document.createElement("div"), {});
                      tem.renderingStyle(evt.item, evt.item.id);
                      break;
                    case "TabBar":
                      tem = new BookmarkPage(document.createElement("div"), {});
                      tem.renderingStyle(evt.item, evt.item.id);
                      break;
                    case "ChoiceColumn":
                      tem = new ChoiceColumn(document.createElement("div"), {});
                      tem.renderingStyle(evt.item, evt.item.id);
                      break;
                    case "Slider":
                      tem = new Slider(document.createElement("div"), {});
                      tem.renderingStyle(evt.item, evt.item.id);
                      break;
                    case "ParameterBlock":
                      break;
                    case "DropDownMenu":
                      tem = new DropDownMenu(document.createElement("div"), {});
                      tem.renderingStyle(evt.item, evt.item.id);
                      break;
                    case "ModalWindow":
                      break;
                    case "PromptInforma":
                      break;
                  }
                }

                indexData[property] += 1;
              }
            }

            //
            let previewComponents = document.querySelectorAll(
              ".preview.showFlex .draggableBox "
            );

            function getComponentAtr() {
              event.stopPropagation();
              console.log("getComponentAtr", origEl);

              if (
                origEl.lastElementChild.id === "ImgLoader" ||
                origEl.lastElementChild.id === "ImgViewer"
              ) {
                document.querySelector(
                  ".parametersBar .parameters .attributes"
                ).style.display = "flex";
                document.querySelector(
                  ".parametersBar .parameters .other >div:nth-of-type(1)"
                ).style.display = "flex";
                document.querySelector(
                  ".parametersBar .parameters .content .loader-icon"
                ).style.display = "block";
                document.querySelector(
                  ".parametersBar .parameters .content .loader-background"
                ).style.display = "block";
              } else if (origEl.lastElementChild.id === "Image") {
                document.querySelector(
                  ".parametersBar .parameters .content .loader-background"
                ).style.display = "block";
              } else {
                document.querySelector(
                  ".parametersBar .parameters .attributes"
                ).style.display = "none";
                document.querySelector(
                  ".parametersBar .parameters .other >div:nth-of-type(1)"
                ).style.display = "none";
                document.querySelector(
                  ".parametersBar .parameters .content .loader-icon"
                ).style.display = "none";
                document.querySelector(
                  ".parametersBar .parameters .content .loader-background"
                ).style.display = "none";
              }

              /** parametersBar show */
              document
                .querySelectorAll(".parametersBar >div")
                .forEach((item) => {
                  if (item.classList.contains("parameters")) {
                    item.classList.remove("hideBlock");
                    item.classList.add("showBlock");
                  } else {
                    item.classList.remove("showBlock");
                    item.classList.add("hideBlock");
                  }
                });
              /** parametersBar show */

              hideOffsetLine();

              showOffsetLine(origEl);

              document.querySelectorAll(".preview.showFlex")[0].style.border =
                "none";
              document
                .querySelectorAll(".preview.showFlex")[0]
                .classList.remove("showAfter");

              origEl.style.border = "solid 2px #0f81e6";
              origEl.classList.add("showAfter");

              let ele;
              if (origEl.id.includes("_")) {
                ele = origEl.id.split("_")[0];
              } else {
                ele = origEl.id;
              }
              let parameters = document.querySelector("#editor .parameters");
              textObj = origEl.lastElementChild;
              selectObj = origEl;
              window.data.selectObj = selectObj;

              switch (ele) {
                case "PrimaryBtn":
                  textObj = origEl.querySelector(".button-text");
                  break;
                case "Button":
                  textObj = origEl.querySelector(".button-text");
                  break;
                case "Input":
                  textObj = origEl.querySelector(".input-text");
                  document.querySelector(
                    ".parameters .content .placeholder-input input"
                  ).placeholder = origEl.querySelector("input").placeholder;
                  break;

                case "Slider":
                  document.querySelector(
                    ".parameters .content .minimum-input input"
                  ).value = origEl.querySelector("input").min;
                  document.querySelector(
                    ".parameters .content .maximum-input input"
                  ).value = origEl.querySelector("input").max;
                  document.querySelector(
                    ".parameters .content .default-value-input input"
                  ).value = origEl.querySelector("input").value;
                  document.querySelector(
                    ".parameters .content .slider-step-input input"
                  ).value = origEl.querySelector("input").step;
                  break;

                case "CheckBox":
                  textObj = origEl.querySelector(".checkbox-text");
                  break;
                case "ParameterBlock":
                  textObj = origEl.querySelector(".parameterBlock-text");
                  break;
                case "NavigationBar":
                  watchChoiceBox(".layout-choiceBox");
                  break;
                case "TabBar":
                  textObj = origEl.querySelector(".tabs");
                  break;
                case "ChoiceColumn":
                  window.data.choiceColumnList = [];
                  document
                    .querySelectorAll(`#${selectObj.id} .container-item`)
                    .forEach((item, index) => {
                      const regex = /url\("(.*?)"/;
                      const match =
                        item.firstElementChild.style.background.match(regex);

                      // 提取匹配到的URL
                      if (match) {
                        const url = match[1];
                        window.data.choiceColumnList.push({
                          url: url,
                          name: selectObj.id,
                          title: item.querySelector("p").innerText,
                          active: false,
                        });
                      }
                    });
                  break;
                case "ImgLoader":
                  textObj = origEl.querySelector(".imageUploader-text");

                  if (
                    !origEl
                      .querySelector(".imageUploader-icon")
                      .src.includes("/framework/Assets/uploadCloud.svg")
                  ) {
                    document
                      .querySelector(
                        ".parameters .loader-icon  .theme-fileName"
                      )
                      .querySelector("div:nth-of-type(1)").innerText = origEl
                      .querySelector(".imageUploader-icon")
                      .src.split("/")
                      .pop();
                    document.querySelector(
                      ".parameters .loader-icon  .theme-fileName"
                    ).style.display = "flex";
                    document.querySelector(
                      ".parameters .icon-image-button"
                    ).style.display = "none";
                  } else {
                    document.querySelector(
                      ".parameters .loader-icon  .theme-fileName"
                    ).style.display = "none";
                    document.querySelector(
                      ".parameters .icon-image-button"
                    ).style.display = "block";
                  }
                  if (
                    origEl.querySelector(".imageUploader-input-contain").style
                      .background
                  ) {
                    document
                      .querySelector(
                        ".parameters .loader-background  .theme-fileName"
                      )
                      .querySelector("div:nth-of-type(1)").innerText = origEl
                      .querySelector(".imageUploader-input-contain")
                      .style.background.split("/")
                      .pop();
                    document.querySelector(
                      ".parameters .loader-background  .theme-fileName"
                    ).style.display = "flex";
                    document.querySelector(
                      ".parameters .image-button"
                    ).style.display = "none";
                  } else {
                    document.querySelector(
                      ".parameters .loader-background  .theme-fileName"
                    ).style.display = "none";
                    document.querySelector(
                      ".parameters .image-button"
                    ).style.display = "block";
                  }
                  break;
                case "Image":
                  if (
                    !origEl.lastElementChild.style.background.includes(
                      "/framework/Assets/editor/image-background.svg"
                    )
                  ) {
                    document
                      .querySelector(
                        ".parameters .loader-background  .theme-fileName"
                      )
                      .querySelector("div:nth-of-type(1)").innerText =
                      origEl.lastElementChild.style.background.split("/").pop();
                    document.querySelector(
                      ".parameters .loader-background  .theme-fileName"
                    ).style.display = "flex";
                    document.querySelector(
                      ".parameters .image-button"
                    ).style.display = "none";
                  } else {
                    document.querySelector(
                      ".parameters .loader-background  .theme-fileName"
                    ).style.display = "none";
                    document.querySelector(
                      ".parameters .image-button"
                    ).style.display = "block";
                  }
                  break;
                case "Button":
                  textObj = origEl.querySelector(".button-text");
                  break;
                case "PrimaryBtn":
                  textObj = origEl.querySelector(".button-text");
                  break;
              }

              showModuleScript();
              showItemList();

              /** 修改preview 颜色块显示颜色*/

              if (textObj.id === "Radio") {
                document.querySelector(
                  "#editor .parameters .content .color-picker .picker-input input"
                ).value = rgbaToHexAndAlpha(
                  textObj.querySelector(".custom-radio").style.color
                )[0];
                document.querySelector(
                  "#editor .parameters .content .color-picker .picker-opacity input"
                ).value = rgbaToHexAndAlpha(
                  textObj.querySelector(".custom-radio").style.color
                )[1];
              } else if (textObj.id === "TreeSelector") {
                document.querySelector(
                  "#editor .parameters .content .color-picker .picker-input input"
                ).value = rgbaToHexAndAlpha(
                  textObj.querySelector(".tree-checkbox-text").style.color
                )[0];
                document.querySelector(
                  "#editor .parameters .content .color-picker .picker-opacity input"
                ).value = rgbaToHexAndAlpha(
                  textObj.querySelector(".tree-checkbox-text").style.color
                )[1];
              } else if (textObj.id === "DropDownMenu") {
                document.querySelector(
                  "#editor .parameters .content .color-picker .picker-input input"
                ).value = rgbaToHexAndAlpha(
                  textObj.querySelector(".title").style.color
                )[0];
                document.querySelector(
                  "#editor .parameters .content .color-picker .picker-opacity input"
                ).value = rgbaToHexAndAlpha(
                  textObj.querySelector(".title").style.color
                )[1];
              } else {
                document.querySelector(
                  "#editor .parameters .content .color-picker .picker-input input"
                ).value = rgbaToHexAndAlpha(textObj.style.color)[0];
                document.querySelector(
                  "#editor .parameters .content .color-picker .picker-opacity input"
                ).value = rgbaToHexAndAlpha(textObj.style.color)[1];
              }

              /** 修改preview 颜色块显示颜色*/

              parameters.querySelector(".ele-title h4").innerText = origEl.id;

              if (attributes.length !== 0) {
                let attributesEle = document.querySelector(
                  "#editor .parameters .attributes"
                );

                let contentHTML = ""; // 用于存储 content 内容的HTML

                attributes.forEach((item) => {
                  if (item.id === origEl.id) {
                    contentHTML = item.content
                      .map((item2) => {
                        return `<div class="${item2.name}-item item">
                  <div>
                    <input type="checkbox" id="inputId-${item2.name}" ${
                          item2.state ? "checked" : ""
                        } />
                    <label for="inputId-${item2.name}"></label>
                  </div>


                </div>`;
                      })
                      .join("");
                  }
                });

                attributesEle.innerHTML = `
                      ${contentHTML}
                      `;
                attributesEle
                  .querySelectorAll(".item input[type='checkbox']")
                  .forEach((item, index) => {
                    item.addEventListener("change", () => {
                      attributes.forEach((item) => {
                        if (item.id === origEl.id) {
                          item.content.forEach((item2, index2) => {
                            if (index === index2) {
                              item2.state = event.target.checked;
                              console.log(
                                "event.target.checked",
                                event.target.checked
                              );
                              let atr = event.target.id.split("-")[1];
                              const imageUploaderElement =
                                document.createElement("div");
                              let tem;
                              switch (atr) {
                                case "isCanvas":
                                  if (event.target.checked) {
                                    document
                                      .querySelector(
                                        `#editor .preview #${selectObj.id} `
                                      )
                                      .setAttribute("isCanvas", "true");
                                    document.querySelector(
                                      `#editor .preview #${selectObj.id} `
                                    ).innerHTML = `
              <canvas class="tool-canvas" width= "100%" height= "100%" style=" border-radius: 8px; background-color: #fff;width: 100%;height: 100%;" >
              </canvas>
          <div class="mouse" style="left: 0;top: 0;position: absolute;width: 16px;height:16px; background: url('./framework/Assets/pens.svg') no-repeat center center /cover; display: none;"></div>
          <div style="display: flex;justify-content: space-between">
            <div id="eraserButton" style="cursor: pointer;width: 20px;height: 20px; background: url('./framework/Assets/eraserButton.svg') no-repeat center center / cover"></div>
            <div id="penButton" style="cursor: pointer;width: 20px;height: 20px; background: url('./framework/Assets/penButton.svg') no-repeat center center / cover"></div>
            <div id="clearCanvasBtn" style="cursor: pointer;width: 20px;height: 20px; background: url('./framework/Assets/clearCanvasBtn.svg') no-repeat center center / cover"></div>
            <div id="backCanvasBtn" style="cursor: pointer;width: 20px;height: 20px; background: url('./framework/Assets/backCanvasBtn.svg') no-repeat center center / cover"></div>
          </div>
                                          `;
                                  } else {
                                    tem = new ImageUploader(
                                      imageUploaderElement,
                                      {
                                        name: "ImgLoader",
                                        frame: {
                                          width: "100%",
                                          height: "100%",
                                        },
                                        attributes: {},
                                        class: [],
                                        content: {},
                                        style: {},
                                        actions: [],
                                        scripts: [],
                                      }
                                    );
                                    document
                                      .querySelector(
                                        `#editor .preview #${selectObj.id} `
                                      )
                                      .removeAttribute("isCanvas");
                                    document.querySelector(
                                      `#editor .preview #${selectObj.id} `
                                    ).innerHTML = "";
                                    tem.startDrawing(
                                      `editor .preview #${selectObj.id} `
                                    );
                                  }

                                  break;
                                case "isPens":
                                  if (event.target.checked) {
                                    document
                                      .querySelector(
                                        `#editor .preview #${selectObj.id} `
                                      )
                                      .setAttribute("isPens", "true");
                                    document.querySelector(
                                      `#editor .preview #${selectObj.id} `
                                    ).innerHTML = `
                                            <div class="draggableBox-rightBottom"></div>
                                            <div class="draggableBox-leftTop"></div>
                                            <div class="draggableBox-rightTop"></div>
                                            <div class="draggableBox-leftBottom"></div>
                                            <div class="moveArea move"></div>
                                          `;
                                    tem = new ImageUploader(
                                      imageUploaderElement,
                                      {
                                        name: "ImgLoader",
                                        frame: {
                                          width: "100%",
                                          height: "100%",
                                        },
                                        attributes: {
                                          isPens: "true",
                                        },
                                        class: [],
                                        content: {},
                                        style: {},
                                        actions: [],
                                        scripts: [],
                                      }
                                    );

                                    tem.startDrawing(
                                      `editor .preview #${selectObj.id} `
                                    );
                                  } else {
                                    tem = new ImageUploader(
                                      imageUploaderElement,
                                      {
                                        name: "ImgLoader",
                                        frame: {
                                          width: "100%",
                                          height: "100%",
                                        },
                                        attributes: {},
                                        class: [],
                                        content: {},
                                        style: {},
                                        actions: [],
                                        scripts: [],
                                      }
                                    );
                                    document
                                      .querySelector(
                                        `#editor .preview #${selectObj.id} `
                                      )
                                      .removeAttribute("isPens");
                                    document.querySelector(
                                      `#editor .preview #${selectObj.id} `
                                    ).innerHTML = `
                                            <div class="draggableBox-rightBottom"></div>
                                            <div class="draggableBox-leftTop"></div>
                                            <div class="draggableBox-rightTop"></div>
                                            <div class="draggableBox-leftBottom"></div>
                                            <div class="moveArea move"></div>
                                            `;
                                    tem.startDrawing(
                                      `editor .preview #${selectObj.id} `
                                    );
                                  }
                                  break;
                                case "isImgCompare":
                                  break;
                                default:
                                  break;
                              }
                            }
                          });
                        }
                      });
                    });
                  });
              }

              parameters.querySelector(
                ".frame  div:nth-of-type(1) input"
              ).value = origEl.style.marginLeft.split("px")[0]
                ? origEl.style.marginLeft.split("px")[0]
                : 0;
              parameters.querySelector(
                ".frame  div:nth-of-type(2) input"
              ).value = origEl.style.marginTop.split("px")[0]
                ? origEl.style.marginTop.split("px")[0]
                : 0;
              parameters.querySelector(
                ".frame  div:nth-of-type(3) input"
              ).value = origEl.style.width.split("px")[0];
              parameters.querySelector(
                ".frame  div:nth-of-type(4) input"
              ).value = origEl.style.height.split("px")[0];

              if (textObj) {
                parameters.querySelector(".content ").style.display = "block";
                if (
                  ele === "TreeSelector" ||
                  ele === "Radio" ||
                  ele === "DropDownMenu" ||
                  ele === "TabBar" ||
                  ele === "NavigationBar"
                ) {
                  // 使用换行符分割文本内容成多个行
                  let lines = textObj.innerText.split("\n");

                  // 创建一个空数组来存储结果
                  let result = [];

                  // 遍历每一行文本，去除首尾空白字符，然后添加到结果数组中
                  for (let i = 0; i < lines.length; i++) {
                    let line = lines[i].trim();
                    if (line.length > 0) {
                      result.push(line);
                    }
                  }

                  let contentHTML = ""; // 用于存储 content 内容的HTML
                  let number, name;

                  if (ele === "Radio") {
                    name = "Option";
                  }
                  if (ele === "TabBar") {
                    name = "Tab";
                  }
                  if (ele === "NavigationBar") {
                    name = "Item";

                    contentHTML = result
                      .map((item, index) => {
                        number = index + 1;
                        return `
                        <div style="width: 100%; height: 21px; display: flex;  margin-top: 15px; margin-bottom: 10px;">
                        <div class="navBar-item-input">
                          <div class="title">${name}${number}</div>
                          <input type="text" value='${item}' />
                        </div>
                        <img class="editor-button" style="margin: 0 3px;width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-editor.svg">
                        <img class="delete-button" style="width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-delete.svg">
                        </div>     
                        `;
                      })
                      .join("");
                    contentHTML += `
                  <div class="button-none">
                    + Add Option
                    </div>

                    `;

                    parameters.querySelector(
                      ".content  .optionsList"
                    ).innerHTML = `${contentHTML}`;

                    parameters
                      .querySelector(".content  .optionsList .button-none")
                      .addEventListener("click", () => {
                        number++;
                        let optionItem = document.createElement("div");
                        optionItem.style.cssText = `
width: 100%; height: 21px; display: flex;  margin-top: 15px; margin-bottom: 10px;
`;
                        optionItem.innerHTML = `
                        
                        <div class="navBar-item-input">
                          <div class="title">${name}${number}</div>
                          <input type="text" value='xx' />
                        </div>
                        <img class="editor-button" style="margin: 0 3px;width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-editor.svg">
                        <img class="delete-button" style="width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-delete.svg">
                        
                      `;

                        // 获取当前点击元素的父元素
                        let parentElement = event.target.parentElement;

                        // 获取当前点击元素在父元素子节点中的位置
                        let currentIndex = Array.from(
                          parentElement.children
                        ).indexOf(event.target);

                        // 使用 insertBefore 方法将新元素插入到当前点击元素的前一个位置
                        parentElement.insertBefore(
                          optionItem,
                          parentElement.children[currentIndex]
                        );
                        handleContent();
                      });
                  } else {
                    contentHTML = result
                      .map((item, index) => {
                        number = index + 1;
                        return `
                        <div style="width: 100%; height: 21px; display: flex;  margin-top: 15px; margin-bottom: 10px;">
                        <div class="navBar-item-input">
                          <div class="title">${name}${number}</div>
                          <input type="text" value='${item}' />
                        </div>
                        <img class="delete-button" style="width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-delete.svg">
                        </div>  
                                 
  
                                `;
                      })
                      .join("");
                    contentHTML += `
                  <div class="button-none">
                    + Add Option
                    </div>

                    `;

                    parameters.querySelector(
                      ".content  .optionsList"
                    ).innerHTML = `${contentHTML}`;

                    parameters
                      .querySelector(".content  .optionsList .button-none")
                      .addEventListener("click", () => {
                        number++;
                        let optionItem = document.createElement("div");
                        optionItem.style.cssText = `
width: 100%; height: 21px; display: flex;  margin-top: 15px; margin-bottom: 10px;
`;
                        optionItem.innerHTML = `
                       
                        <div class="navBar-item-input">
                          <div class="title">${name}${number}</div>
                          <input type="text" value='xx' />
                        </div>
                        <img class="delete-button" style="width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-delete.svg">
                         
                      `;

                        // 获取当前点击元素的父元素
                        let parentElement = event.target.parentElement;

                        // 获取当前点击元素在父元素子节点中的位置
                        let currentIndex = Array.from(
                          parentElement.children
                        ).indexOf(event.target);

                        // 使用 insertBefore 方法将新元素插入到当前点击元素的前一个位置
                        parentElement.insertBefore(
                          optionItem,
                          parentElement.children[currentIndex]
                        );
                        handleContent();
                      });
                  }

                  handleContent();
                } else {
                  parameters.querySelector(".content  .inputBox input").value =
                    textObj.innerText;
                  parameters.querySelector(
                    "#frame-325  .inputBox input"
                  ).value = textObj.style.fontSize.split("px")[0];
                }
              } else {
                parameters.querySelector(".content ").style.display = "none";
              }
            }
          },
          onMove: function (evt) {
            //   console.log("onMove");
            hideOffsetLine();
          },
        }
      );

      // 创建一个ResizeObserver实例，传入回调函数
      const resizeObserver = new ResizeObserver((entries) => {
        let offsetLeft = document.querySelectorAll(
          ".preview.showFlex .offsetLeft"
        )[0];
        let offsetTop = document.querySelectorAll(
          ".preview.showFlex .offsetTop"
        )[0];

        if (
          selectObj &&
          offsetLeft.style.width !== "0px" &&
          offsetTop.style.height !== "0px"
        ) {
          showOffsetLine(selectObj);
        }
      });

      // 开始观察DOM元素的变化
      resizeObserver.observe(document.querySelector("#editor .preview "));

      function handleContent() {
        console.log("textObj", textObj);
        if (selectObj.lastElementChild.id === "TreeSelector") {
          let itemArr = event.target.value.split(",");

          let TreeSelectorElement = document.createElement("div");
          let tem = new TreeSelector(TreeSelectorElement, {
            name: "TreeSelector",
            frame: {
              width: "100%",
              height: "100%",
            },
            attributes: {},
            class: [],
            content: { list: [...itemArr] },
            style: {},
            actions: [],
            scripts: [],
          });

          document.querySelector(
            `#editor .preview #${selectObj.id} `
          ).innerHTML = "";
          tem.startDrawing(`editor .preview #${selectObj.id} `);
        } else if (selectObj.lastElementChild.id === "Radio") {
          let itemArr = [];
          document
            .querySelectorAll(".parameters .content .optionsList input")
            .forEach((item) => {
              console.log("item", item);
              itemArr.push(item.value);
            });

          let SingleButtonElement = document.createElement("div");
          let tem = new SingleButton(SingleButtonElement, {
            name: "Radio",
            frame: {
              width: "100%",
              height: "100%",
            },
            attributes: {},
            class: [],
            content: { list: [...itemArr] },
            style: {},
            actions: [],
            scripts: [],
          });

          document.querySelector(
            `#editor .preview #${selectObj.id} `
          ).innerHTML = `
          <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
          `;
          tem.startDrawing(`editor .preview #${selectObj.id} `);

          document
            .querySelectorAll(".content .optionsList .delete-button")
            .forEach((item) => {
              item.addEventListener("click", () => {
                item.parentElement.remove();
                handleContent();
              });
            });
          document
            .querySelectorAll(".content  .optionsList input")
            .forEach((item) => {
              item.addEventListener("change", handleContent);
            });
        } else if (selectObj.lastElementChild.id === "TabBar") {
          let itemArr = [];
          document
            .querySelectorAll(".parameters .content .optionsList input")
            .forEach((item) => {
              console.log("item", item);
              itemArr.push(item.value);
            });

          let BookmarkPageElement = document.createElement("div");
          let tem = new BookmarkPage(BookmarkPageElement, {
            name: "TabBar",
            frame: {
              width: "100%",
              height: "100%",
            },
            attributes: {},
            class: [],
            content: { list: [...itemArr] },
            style: {},
            actions: [],
            scripts: [],
          });

          document.querySelector(
            `#editor .preview #${selectObj.id} `
          ).innerHTML = `
          <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
          `;
          tem.startDrawing(`editor .preview #${selectObj.id} `);

          document
            .querySelectorAll(".content .optionsList .delete-button")
            .forEach((item) => {
              item.addEventListener("click", () => {
                item.parentElement.remove();
                handleContent();
              });
            });
          document
            .querySelectorAll(".content  .optionsList input")
            .forEach((item) => {
              item.addEventListener("change", handleContent);
            });
        } else if (selectObj.lastElementChild.id === "DropDownMenu") {
          let itemArr = event.target.value.split(",");
          console.log("itemArr", itemArr);

          let DropDownMenuElement = document.createElement("div");
          let tem = new DropDownMenu(DropDownMenuElement, {
            name: "DropDownMenu",
            frame: {
              width: "100%",
              height: "100%",
            },
            attributes: {},
            class: [],
            content: { list: [...itemArr] },
            style: {},
            actions: [],
            scripts: [],
          });

          document.querySelector(
            `#editor .preview #${selectObj.id} `
          ).innerHTML = "";
          tem.startDrawing(`editor .preview #${selectObj.id} `);
        } else if (selectObj.lastElementChild.id === "NavigationBar") {
          let itemArr = [];

          document
            .querySelectorAll(".parameters .content .optionsList  input")
            .forEach((item, index) => {
              if (
                index <
                document.querySelectorAll(`#${selectObj.id} .nav-item img`)
                  .length
              ) {
                itemArr.push({
                  icon: Array.from(
                    document.querySelectorAll(`#${selectObj.id} .nav-item img`)
                  )[index].src,
                  text: item.value,
                });
              } else {
                itemArr.push({
                  icon: "./framework/Assets/nav-dashboardicon.svg",
                  text: item.value,
                });
              }
            });

          let isLayout = document
            .querySelector(`#${selectObj.id}`)
            .getAttribute("layout");

          let NavigationBarElement = document.createElement("div");
          let tem = new NavigationBar(NavigationBarElement, {
            name: "NavigationBar",
            frame: {
              width: "100%",
              height: "100%",
            },
            attributes: {
              layout: isLayout,
            },
            class: [],
            content: { list: [...itemArr] },
            style: {},
            actions: [],
            scripts: [],
          });

          document.querySelector(
            `#editor .preview #${selectObj.id} `
          ).innerHTML = `
          <div class="draggableBox-rightBottom"></div>
                  <div class="draggableBox-leftTop"></div>
                  <div class="draggableBox-rightTop"></div>
                  <div class="draggableBox-leftBottom"></div>
                  <div class="moveArea move"></div>
          `;
          tem.startDrawing(`editor .preview #${selectObj.id} `);

          document
            .querySelectorAll(".content .optionsList .delete-button")
            .forEach((item) => {
              item.addEventListener("click", () => {
                console.log("delete");
                item.parentElement.remove();
                handleContent();
              });
            });
          document
            .querySelectorAll(".content .optionsList .editor-button")
            .forEach((item) => {
              item.addEventListener("click", () => {
                handleContent();
              });
            });
          document
            .querySelectorAll(".content  .optionsList input")
            .forEach((item) => {
              item.addEventListener("change", handleContent);
            });
        } else {
          textObj.innerText = event.target.value;
        }
      }
      function handleX() {
        selectObj.style.border = "solid 2px #0f81e6";
        selectObj.classList.add("showAfter");
        selectObj.style.marginLeft = event.target.value + "px";
        showOffsetLine(selectObj);
      }
      function handleY() {
        selectObj.style.border = "solid 2px #0f81e6";
        selectObj.classList.add("showAfter");
        selectObj.style.marginTop = event.target.value + "px";
        showOffsetLine(selectObj);
      }
      function handleW() {
        selectObj.style.border = "solid 2px #0f81e6";
        selectObj.classList.add("showAfter");
        selectObj.style.width = event.target.value + "px";
        showOffsetLine(selectObj);
      }
      function handleH() {
        selectObj.style.border = "solid 2px #0f81e6";
        selectObj.classList.add("showAfter");
        selectObj.style.height = event.target.value + "px";
        showOffsetLine(selectObj);
      }
      function rgbaFromHexAndOpacity(hexColor, opacityPercentage) {
        // 去除可能包含的#号
        hexColor = hexColor.replace("#", "");

        // 解析颜色通道的十六进制值
        var r = parseInt(hexColor.substring(0, 2), 16);
        var g = parseInt(hexColor.substring(2, 4), 16);
        var b = parseInt(hexColor.substring(4, 6), 16);

        // 将透明度从百分比转换为0到1之间的小数
        var opacity = opacityPercentage / 100;

        // 创建RGBA颜色字符串
        var rgbaColor =
          "rgba(" + r + ", " + g + ", " + b + ", " + opacity + ")";

        return rgbaColor;
      }
      function handleColor() {
        console.log("textObj", textObj);
        let rgbaColor = rgbaFromHexAndOpacity(
          document.querySelector(
            "#editor .parameters .content .color-picker .picker-input input"
          ).value,
          document.querySelector(
            "#editor .parameters .content .color-picker .picker-opacity input"
          ).value
        );

        if (textObj.id === "Radio") {
          textObj.querySelectorAll(".custom-radio").forEach((item) => {
            item.style.color = rgbaColor;
          });
        } else if (textObj.id === "TreeSelector") {
          textObj.querySelectorAll(".tree-checkbox-text").forEach((item) => {
            item.style.color = rgbaColor;
          });
        } else if (textObj.id === "DropDownMenu") {
          textObj.querySelector(".title").style.color = rgbaColor;
          textObj.querySelectorAll(".menu-item").forEach((item) => {
            item.style.color = rgbaColor;
          });
        } else if (textObj.id === "Button") {
          textObj.querySelector(".button-text").style.color = rgbaColor;
        } else if (textObj.id === "PrimaryBtn") {
          textObj.querySelector(".button-text").style.color = rgbaColor;
        } else {
          textObj.style.color = rgbaColor;
        }
      }
      function rgbaToHexAndAlpha(rgbaColor) {
        // 创建一个新的style标签来插入修改后的样式
        let styleTag = document.createElement("style");
        document.head.appendChild(styleTag);
        if (rgbaColor == "") {
          // 修改伪元素的样式
          document
            .querySelector(".pickr .pcr-button")
            .style.setProperty("--pcr-color", "rgba(255, 255, 255, 1)");

          return ["#FFFFFF", "100"]; // 当colorString为null时返回默认值
        }
        // 检查颜色字符串是否有效
        var colorRegex = /^(rgba|rgb)\((\d+), (\d+), (\d+)(?:, ([0-9.]+))?\)$/;
        var match = rgbaColor.match(colorRegex);

        if (!match) {
          return null; // 无效的颜色格式
        }

        // 提取颜色分量
        var red = parseInt(match[2]);
        var green = parseInt(match[3]);
        var blue = parseInt(match[4]);
        var alpha = match[5] ? Math.ceil(parseFloat(match[5]) * 100) : 100;

        // 将颜色分量转换为十六进制
        var hex =
          "#" +
          ((1 << 24) | (red << 16) | (green << 8) | blue).toString(16).slice(1);

        // 修改伪元素的样式
        document
          .querySelector(".pickr .pcr-button")
          .style.setProperty("--pcr-color", `${rgbaColor}`);

        return [hex, alpha.toString()];
      }

      function handleFontSize() {
        textObj.style.fontSize = event.target.value + "px";
      }
      function handleStyle() {
        let styleArr = event.target.value.split(",");
        styleArr.forEach((item) => {
          let atrName = item.split(":")[0];
          let atrContent = item.split(":")[1];
          selectObj.lastElementChild.style[atrName] = atrContent;
        });
      }
      function onblurElement() {
        event.stopPropagation();
        document
          .querySelectorAll(".preview.showFlex")[0]
          .classList.add("showAfter");
        document.querySelectorAll(".preview.showFlex")[0].style.border =
          "solid 2px #0f81e6";
        hideOffsetLine();
        console.log("onblurElement");
      }

      async function deleteScriptItem(name, itemIndex, index) {
        await window.myApi.deleteFileFunction(
          `DemoAppText/${manifest.appname}/scripts/${selectObj.id}-${itemIndex}.js`
        );
        // scriptList = scriptList.filter(
        //   (item) => item.name !== name && item.index !== index
        // );
        scriptList.splice(index, 1);
      }
      async function deletePngItem(name, itemIndex, index) {
        await window.myApi.deleteFileFunction(
          `DemoAppText/${manifest.appname}/assets/${selectObj.id}-${itemIndex}.js`
        );
        // scriptList = scriptList.filter(
        //   (item) => item.name !== name && item.index !== index
        // );
        scriptList.splice(index, 1);
      }
      async function addScriptItem(name) {
        let isItem = false;
        let scriptIndex;
        scriptList.forEach((item) => {
          if (item.name === selectObj.id) {
            isItem = true;

            scriptIndex = item.index + 1;
          }
        });
        if (isItem) {
          scriptList.push({
            name: selectObj.id,
            index: scriptIndex,
          });
        } else {
          scriptList.push({
            name: selectObj.id,
            index: 1,
          });
          scriptIndex = 1;
        }

        await window.myApi.saveFileFunction(
          `DemoAppText/${manifest.appname}/scripts`,
          `${selectObj.id + "-" + scriptIndex}.js`,
          "",
          true
        );
      }
      function addItem(name) {
        window.data.choiceColumnList.push({
          name: selectObj.id,
          title: `item${window.data.choiceColumnList.length + 1}`,
          active: false,
          url: "./framework/Assets/editor/image-item-background.svg",
        });
        {
          const ChoiceColumnElement = document.createElement("div");
          const tem = new ChoiceColumn(ChoiceColumnElement, {
            name: "ChoiceColumn",
            frame: { width: "100%", height: "100%" },
            attributes: {},
            class: [],
            content: {
              list: [...window.data.choiceColumnList],
            },
            style: {},
            actions: [],
            script: [],
          });
          document.querySelector(`#${selectObj.id}`).lastElementChild.remove();
          tem.startDrawing(`${selectObj.id}`);
        }
      }
      function showItemList() {
        let addScriptButton = document.querySelector(".add-item-button");

        // 获取最后一个子元素
        var lastChild = addScriptButton.parentNode.lastElementChild;

        // 移除其他子元素
        while (addScriptButton.parentNode.firstChild) {
          if (addScriptButton.parentNode.firstChild !== lastChild) {
            addScriptButton.parentNode.removeChild(
              addScriptButton.parentNode.firstChild
            );
          } else {
            break; // 停止移除操作，保留最后一个子元素
          }
        }

        for (let i = 0; i < window.data.choiceColumnList.length; i++) {
          const item = window.data.choiceColumnList[i];

          if (item.name == selectObj.id) {
            console.log(item.name);
            let scriptItem = document.createElement("div");
            scriptItem.style.cssText = `
              display: flex;
              align-items: center;
              color: rgba(191, 192, 196, 0.80);
              margin-bottom: 8px;
            `;
            scriptItem.innerHTML = `
              <img src="./framework/Assets/editor/add-item-code.svg" />
              <span style="font-size: 12px;flex:1 ;padding: 0 6px 0 6px;white-space: nowrap;text-overflow: ellipsis;overflow:hidden;">${
                selectObj.id + "-" + item.index
              }.png</span>
              <img class="editor" style="cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-editor.svg" />
              <img class="delete" style="cursor:pointer;" src="./framework/Assets/editor/add-script-delete.svg" />
            `;

            scriptItem
              .querySelector(".delete")
              .addEventListener("click", async () => {
                scriptItem.remove();
                deletePngItem(selectObj.id, item.index, i);
                if (addScriptButton.parentNode.children.length == 1) {
                  addScriptButton.parentNode.classList.remove("dashedBox");
                }
              });
            scriptItem
              .querySelector(".editor")
              .addEventListener("click", async () => {
                window.data.choiceColumnList[i].active = true;
                const PopUpsElement = document.createElement("div");
                const tem = new PopUps(PopUpsElement, {
                  name: "PopUps",
                  frame: {
                    width: "276px",
                    height: "198px",
                  },
                  attributes: {
                    type: "itemEditor",
                  },
                  content: {},
                  style: {},
                });
                tem.startDrawing("editor .preview-container");
                setTimeout(() => {
                  console.log(
                    " window.data.choiceColumnList",
                    window.data.choiceColumnList
                  );
                  /** popups-image-button*/
                  document
                    .querySelector("#PopUps .popup-image-button")
                    .addEventListener("click", () => {
                      let fileInput = document.querySelector(
                        "#PopUps .theme-button-input"
                      );
                      let themeFileName = document.querySelector(
                        "#PopUps   .theme-fileName"
                      );
                      fileInput.click();
                      themeFileName
                        .querySelector(" .theme-delete-button")
                        .addEventListener("click", () => {
                          themeFileName.style.display = "none";
                          document.querySelector(
                            "#PopUps .popup-image-button"
                          ).style.display = "block";

                          document
                            .querySelectorAll(
                              `#${selectObj.id} .container-item > div:nth-of-type(1)`
                            )
                            .forEach((item, index) => {
                              if (index === i) {
                                item.style.background = ``;
                                window.data.choiceColumnList[i].active = false;
                              }
                            });
                        });
                      fileInput.addEventListener("change", async function () {
                        let selectedFile = fileInput.files[0];
                        console.log("selectedFile", selectedFile);
                        // 将本地文件路径转换为file:// URL
                        let fileUrl =
                          "file://" + selectedFile.path.replace(/\\/g, "/");
                        let targetPath = await window.myApi.cloneFileFunction(
                          selectedFile.path.replace(/\\/g, "/"),
                          `DemoAppText/${manifest.appname}/assets`
                        );

                        themeFileName.querySelector(
                          "div:nth-of-type(1)"
                        ).innerText = selectedFile.name;
                        themeFileName.style.display = "flex";
                        document.querySelector(
                          "#PopUps .popup-image-button"
                        ).style.display = "none";

                        document
                          .querySelectorAll(
                            `#${selectObj.id} .container-item > div:nth-of-type(1)`
                          )
                          .forEach((item, index) => {
                            if (index === i) {
                              window.data.choiceColumnList.forEach((item) => {
                                if (item.active) {
                                  item.url = targetPath;
                                }
                              });
                              item.style.background = `url('${targetPath}')no-repeat center center / cover`;
                            }
                          });
                      });
                    });
                  /** popups-image-button*/
                  let imageName = "";

                  selectObj
                    .querySelectorAll(".container-item > div:nth-of-type(1)")
                    .forEach((item, index) => {
                      if (index === i) {
                        console.log(
                          "popup",
                          i,
                          !item.style.background.includes(
                            "image-item-background"
                          )
                        );
                        imageName = item.style.background.split("/").pop();
                        if (
                          !item.style.background.includes(
                            "image-item-background"
                          )
                        ) {
                          document
                            .querySelector("#PopUps .theme-fileName")
                            .querySelector("div:nth-of-type(1)").innerText =
                            imageName;
                          document.querySelector(
                            "#PopUps .theme-fileName"
                          ).style.display = "flex";
                          document.querySelector(
                            "#PopUps .popup-image-button"
                          ).style.display = "none";
                        } else {
                          document.querySelector(
                            "#PopUps .theme-fileName"
                          ).style.display = "none";
                          document.querySelector(
                            "#PopUps .popup-image-button"
                          ).style.display = "block";
                        }
                      }
                    });
                }, 0);
              });

            addScriptButton.parentNode.insertBefore(
              scriptItem,
              addScriptButton
            );

            addScriptButton.parentNode.classList.add("dashedBox");
          } else {
          }
        }
      }
      function showModuleScript() {
        console.log("scriptList", scriptList);
        let addScriptButton = document.querySelector(".add-script-button");

        if (addScriptButton.parentNode.classList.contains("dashedBox")) {
          addScriptButton.parentNode.classList.remove("dashedBox");

          // 获取最后一个子元素
          var lastChild = addScriptButton.parentNode.lastElementChild;

          // 移除其他子元素
          while (addScriptButton.parentNode.firstChild) {
            if (addScriptButton.parentNode.firstChild !== lastChild) {
              addScriptButton.parentNode.removeChild(
                addScriptButton.parentNode.firstChild
              );
            } else {
              break; // 停止移除操作，保留最后一个子元素
            }
          }
        }
        for (let i = 0; i < scriptList.length; i++) {
          const item = scriptList[i];

          if (item.name == selectObj.id) {
            console.log(item.name);
            let scriptItem = document.createElement("div");
            scriptItem.style.cssText = `
              display: flex;
              align-items: center;
              color: rgba(191, 192, 196, 0.80);
              margin-bottom: 8px;
            `;
            scriptItem.innerHTML = `
              <img src="./framework/Assets/editor/add-script-code.svg" />
              <span style="font-size: 12px;flex:1 ;padding: 0 24px 0 6px">${
                selectObj.id + "-" + item.index
              }.js</span>
              <img class="editor" style="cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-editor.svg" />
              <img class="delete" style="cursor:pointer;" src="./framework/Assets/editor/add-script-delete.svg" />
            `;

            scriptItem
              .querySelector(".delete")
              .addEventListener("click", async () => {
                scriptItem.remove();
                deleteScriptItem(selectObj.id, item.index, i);
                if (addScriptButton.parentNode.children.length == 1) {
                  addScriptButton.parentNode.classList.remove("dashedBox");
                }
              });
            scriptItem
              .querySelector(".editor")
              .addEventListener("click", async () => {
                await window.myApi.openFileFunction(
                  selectObj.id + "-" + item.index + ".js",
                  manifest
                );
              });
            addScriptButton.parentNode.insertBefore(
              scriptItem,
              addScriptButton
            );

            addScriptButton.parentNode.classList.add("dashedBox");
          } else {
          }
        }
      }
      function showOffsetLine(origEl) {
        console.log("showOffsetLine");
        let offsetLeft = document.querySelectorAll(
          ".preview.showFlex .offsetLeft"
        )[0];
        let offsetTop = document.querySelectorAll(
          ".preview.showFlex .offsetTop"
        )[0];
        let topLine =
          origEl.getBoundingClientRect().top -
          document
            .querySelectorAll(".preview.showFlex .preview-content")[0]
            .getBoundingClientRect().top;
        let leftLine =
          origEl.getBoundingClientRect().left -
          document
            .querySelectorAll(".preview.showFlex .preview-content")[0]
            .getBoundingClientRect().left;

        // offsetLeft.style.height =
        //   origEl.offsetTop +
        //   Number(origEl.style.height.split("px")[0]) / 2 +
        //   2 +
        //   "px";
        // offsetLeft.style.width = origEl.offsetLeft - 4 + "px";
        // offsetTop.style.height = origEl.offsetTop - 4 + "px";
        // offsetTop.style.width =
        //   origEl.offsetLeft +
        //   Number(origEl.style.width.split("px")[0]) / 2 +
        //   2 +
        //   "px";
        offsetLeft.style.height =
          topLine + Number(origEl.style.height.split("px")[0]) / 2 + 4 + "px";
        offsetLeft.style.width = leftLine - 2 + "px";
        offsetTop.style.height = topLine - 2 + "px";
        offsetTop.style.width =
          leftLine + Number(origEl.style.width.split("px")[0]) / 2 + 4 + "px";
      }
      function hideOffsetLine() {
        console.log("tippyInstances", tippyInstances, scriptList);

        let offsetLeft = document.querySelectorAll(
          ".preview.showFlex .offsetLeft"
        )[0];
        let offsetTop = document.querySelectorAll(
          ".preview.showFlex .offsetTop"
        )[0];
        if (selectObj) {
          selectObj.classList.remove("showAfter");
          offsetLeft.style.width = "0";
          offsetTop.style.height = "0";

          if (selectObj.classList.contains("component-contain")) {
            selectObj.style.border = "2px solid transparent";
          }
        }
      }
      function hasTippyInstance(element) {
        return !!element._tippy;
      }
      function hideTippy() {
        tippyInstances.forEach((instance) => {
          instance.hide();
        });
      }
      function watchChoiceBox(id) {
        function handleChoiceChange() {
          let choice = document.querySelector(
            `${id} input[type="radio"]:checked`
          ).parentElement.innerText;
          if (id === ".layout-choiceBox") {
            if (choice === "H-Layout") {
              if (
                document
                  .querySelector(`#editor .preview #${selectObj.id} `)
                  .getAttribute("v-layout")
              ) {
                document
                  .querySelector(`#editor .preview #${selectObj.id} `)
                  .removeAttribute("v-layout");
              }
              document
                .querySelector(`#editor .preview #${selectObj.id} `)
                .setAttribute("layout", "h-layout");
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).style.top = "0";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).style.height = "30px";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).style.width = "100%";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).style.position = "absolute";
              document.querySelector(
                `#editor .preview #${selectObj.id} nav`
              ).style.flexDirection = "row";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).lastElementChild.style.top = "0";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).lastElementChild.style.height = "30px";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).lastElementChild.style.width = "100%";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).lastElementChild.style.position = "absolute";
              document.querySelector(
                `#editor .preview #${selectObj.id} nav`
              ).style.flexDirection = "row";
            } else {
              if (
                document
                  .querySelector(`#editor .preview #${selectObj.id} `)
                  .getAttribute("h-layout")
              ) {
                document
                  .querySelector(`#editor .preview #${selectObj.id} `)
                  .removeAttribute("h-layout");
              }
              document
                .querySelector(`#editor .preview #${selectObj.id} `)
                .setAttribute("layout", "v-layout");
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).style.left = "0";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).style.height = "100%";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).style.width = "100px";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).style.position = "absolute";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).lastElementChild.style.left = "0";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).lastElementChild.style.height = "100%";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).lastElementChild.style.width = "100px";
              document.querySelector(
                `#editor .preview #${selectObj.id} `
              ).lastElementChild.style.position = "absolute";
              document.querySelector(
                `#editor .preview #${selectObj.id} nav`
              ).style.flexDirection = "column";
            }
          }

          hideOffsetLine();
        }
        handleChoiceChange();
        document
          .querySelector(`${id}`)
          .addEventListener("change", handleChoiceChange);
      }

      /** click preview showFlex */
      document
        .querySelectorAll(".preview.showFlex")[0]
        .addEventListener("mousedown", () => {
          onblurElement();
          selectObj = event.target;
          document.querySelectorAll(".parametersBar > div").forEach((item) => {
            if (item.classList.contains("windowParamsBar")) {
              item.classList.add("showBlock");
              item.classList.remove("hideBlock");
            } else {
              item.classList.add("hideBlock");
              item.classList.remove("showBlock");
            }
          });

          document
            .querySelectorAll(".preview.showFlex .draggable")
            .forEach((item) => {
              console.log(item);
              item.addEventListener("mousedown", () => {
                event.stopPropagation();
                console.log("draggable");
                document.querySelectorAll(".preview.showFlex")[0].style.border =
                  "none";
                document
                  .querySelectorAll(".preview.showFlex")[0]
                  .classList.remove("showAfter");
              });
            });
        });
      /** click preview showFlex */

      document.addEventListener("mousedown", () => {
        document.querySelectorAll(".preview.showFlex")[0].style.border = "none";
        document
          .querySelectorAll(".preview.showFlex")[0]
          .classList.remove("showAfter");
        hideOffsetLine();
      });

      let parameters = document.querySelector("#editor .parameters");

      parameters
        .querySelector(".content .inputBox input")
        .addEventListener("change", handleContent);
      parameters
        .querySelector("#frame-325 .inputBox input")
        .addEventListener("change", handleFontSize);

      /** frame */
      parameters
        .querySelector(".frame div:nth-of-type(1) input")
        .addEventListener("change", handleX);

      parameters
        .querySelector(".frame div:nth-of-type(2) input")
        .addEventListener("change", handleY);

      parameters
        .querySelector(".frame div:nth-of-type(3) input")
        .addEventListener("change", handleW);

      parameters
        .querySelector(".frame div:nth-of-type(4) input")
        .addEventListener("change", handleH);
      /** frame */

      /** other */

      // 创建 MutationObserver 实例，传入一个回调函数
      const observer = new MutationObserver((mutationsList, observer) => {
        // 遍历所有观察到的变动
        for (const mutation of mutationsList) {
          if (
            mutation.type === "attributes" &&
            mutation.attributeName === "value"
          ) {
            // 当 value 属性发生变化时触发
            const newValue = mutation.target.value;
            handleColor();

            // 在这里执行处理新值的逻辑
          }
        }
      });

      // 配置观察选项，监听属性值变化
      const config = { attributes: true, attributeFilter: ["value"] };

      // 开始观察指定的 input 元素
      observer.observe(
        parameters.querySelector(".content .color-picker .picker-input input"),
        config
      );
      observer.observe(
        parameters.querySelector(
          ".content .color-picker .picker-opacity input"
        ),
        config
      );
      /** other */

      /** export json*/
      function traverseDOM(element, parentComponent) {
        // 检查当前元素是否具有类名 "component-contain"
        if (
          element.classList.contains("component-contain") &&
          element.lastElementChild !== null
        ) {
          // 创建一个组件对象
          // console.log(
          //   "element.lastElementChild.id",
          //   element,
          //   element.lastElementChild.id
          // );
          let component = {
            type: element.lastElementChild.id || "",
            name: element.id || "",
            frame: {
              width: element.style.width || element.style.minWidth || "",
              height: element.style.height || element.style.minHeight || "",
              x: element.style.marginLeft || "",
              y: element.style.marginTop || "",
              color: element.style.color || "",
            },
            attributes: {
              type: element.lastElementChild.getAttribute("type") || "",
            },
            content: {},
            style: {},
            actions: [],
            scripts: [],
          };
          scriptList.forEach((item) => {
            if (item.name === element.id) {
              component.scripts.push(
                `./DemoAppText/${manifest.appname}/scripts/${element.id}.js`
              );
            }
          });

          switch (element.lastElementChild.id) {
            case "PrimaryBtn":
              component.frame.color =
                element.querySelector(".button-text").style.color;
              component.content.text =
                element.querySelector(".button-text").innerText;
              component.type = "Button";
              component.attributes.type = "important";

              break;
            case "Button":
              component.frame.color =
                element.querySelector(".button-text").style.color;
              component.content.text =
                element.querySelector(".button-text").innerText;
              component.type = "Button";
              component.attributes.type = "timelyImportant";
              break;
            case "Label":
              component.content.text = element.innerText;
              component.type = "Text";
              component.attributes.type = "headline";
              break;
            case "Title":
              component.content.text = element.innerText;
              component.type = "Text";
              component.attributes.type = "subtitle";
              break;
            case "Subtitle":
              component.content.text = element.innerText;
              component.type = "Text";
              component.attributes.type = "textContent";
              break;
            case "Input":
              component.frame.color =
                element.querySelector(".input-text").style.color;
              component.content.text =
                element.querySelector(".input-text").innerText;
              component.type = "Input";
              component.attributes.type = "input";
              component.attributes.placeholder =
                element.querySelector("input").placeholder;
              break;
            // case "Input-Search":
            //   component.frame.color =
            //     element.querySelector(".input-text").style.color;
            //   component.content.text =
            //     element.querySelector(".input-text").innerText;
            //   component.type = "Input";
            //   component.attributes.type = "search";
            //   break;
            // case "Input-Default":
            //   component.frame.color =
            //     element.querySelector(".input-text").style.color;
            //   component.content.text =
            //     element.querySelector(".input-text").innerText;
            //   component.type = "Input";
            //   component.attributes.type = "default";
            //   break;
            // case "Input-Default-IsTextarea":
            //   component.frame.color =
            //     element.querySelector(".input-text").style.color;
            //   component.content.text =
            //     element.querySelector(".input-text").innerText;
            //   component.type = "Input";
            //   component.attributes.type = "default";
            //   component.attributes.IsTextarea = "true";
            //   break;
            case "CheckBox":
              component.frame.color =
                element.querySelector(".checkbox-text").style.color;
              component.content.text =
                element.querySelector(".checkbox-text").innerText;

              break;
            case "ParameterBlock":
              component.frame.color = element.querySelector(
                ".parameterBlock-text"
              ).style.color;
              component.content.text = element.querySelector(
                ".parameterBlock-text"
              ).innerText;

              break;
            case "ImgViewer":
              if (
                element.querySelector(".imageUploader-input-contain").style
                  .background !== ""
              ) {
                component.content.backgroundImage = element.querySelector(
                  ".imageUploader-input-contain"
                ).style.background;
              }
              if (
                element.querySelector(` .icon > img`).src !==
                `./framework/Assets/imageDisplay-icon.svg`
              ) {
                component.content.iconImage =
                  element.querySelector(` .icon > img`).src;
              }
              break;

            case "ImgLoader":
              if (element.getAttribute("isCanvas")) {
                component.attributes.isCanvas = "true";
              }
              console.log("ImgLoader", element);
              if (element.getAttribute("isPens")) {
                component.attributes.isPens = "true";
              }
              if (
                element.querySelector(".imageUploader-input-contain").style
                  .background !== ""
              ) {
                component.content.backgroundImage = element.querySelector(
                  ".imageUploader-input-contain"
                ).style.background;
              }
              if (
                element.querySelector(` .imageUploader-icon`).src !==
                `./framework/Assets/uploadCloud.svg`
              ) {
                component.content.iconImage =
                  element.querySelector(` .imageUploader-icon`).src;
              }
              component.frame.color = element.querySelector(
                ".imageUploader-text"
              ).style.color;
              component.content.text = element.querySelector(
                ".imageUploader-text"
              ).innerText;

              break;
            case "TreeSelector":
              component.content.list = element.innerText.split("\n");
              break;
            case "Radio":
              component.content.list = element.innerText.split("\n");
              break;
            case "DropDownMenu":
              component.content.list = element.innerText.split("\n");
              break;
            case "TabBar":
              component.type = "BookmarkPage";
              component.content.list = element
                .querySelector(".tabs")
                .innerText.split("\n");
              component.frame.color =
                element.querySelector(".tabs").style.color;

              break;
            case "ChoiceColumn":
              component.content.list = [];
              element.querySelectorAll(".container-item").forEach((item) => {
                const regex = /url\(["']([^"']+)["']\)/;
                const match =
                  item.firstElementChild.style.background.match(regex);
                component.content.list.push({
                  url: match[1],
                });
              });

              break;
            case "NavigationBar":
              component.content.list = [];
              element.innerText.split("\n").forEach((item) => {
                component.content.list.push({
                  icon: "./framework/assets/nav-dashboardicon.svg",
                  text: item,
                });
              });
              break;
          }
          component.style.margin = "4px";
          component.style.border = "2px solid transparent";

          console.log(
            " element.lastElementChild.style.cssText",
            element.lastElementChild.style.cssText
          );
          let styleArr = element.lastElementChild.style.cssText.split(";");
          for (let i = 0; i < styleArr.length - 1; i++) {
            let property = styleArr[i].split(":")[0];
            let value = styleArr[i].split(":")[1];

            // 输出属性名和属性值
            if (
              !property.includes("width") &&
              !property.includes("height") &&
              !property.includes("min-width") &&
              !property.includes("min-height") &&
              !property.includes("margin-left") &&
              !property.includes("margin-top")
            ) {
              component.style[property.trim()] = value;
            }
          }

          // 将组件对象添加到父组件的 children 数组中（如果存在）
          if (element.parentNode.classList.contains("preview")) {
            parentComponent.push(component);
          } else {
            parentComponent.children = parentComponent.children || [];
            parentComponent.children.push(component);
          }

          // 设置当前组件为父组件
          parentComponent = component;
        }
        // console.log("element", element);

        // 获取所有子元素
        var childElements = element.children;

        // 遍历子元素
        for (var i = 0; i < childElements.length; i++) {
          // 递归调用遍历函数，处理子元素，并传递当前组件作为父组件
          traverseDOM(childElements[i], parentComponent);
        }
      }

      document
        .querySelector("nav .build-button")
        .addEventListener("click", async () => {
          onblurElement();
          document.querySelectorAll(".preview").forEach(async (item) => {
            let layout = [];
            let dom = item;
            let pageName = `page${item.getAttribute("data-preview")}`;
            console.log("pageName", manifest);
            traverseDOM(dom, layout);

            let previewBackground = document.querySelector(
              ".preview .preview-content"
            ).style.background;

            let data = {
              pageData: {
                name: "",
                time: "",
                config: {
                  style: {
                    background: previewBackground
                      ? previewBackground
                      : "#353945",
                    display: "flex",
                    "flex-direction": "column",
                    "align-items": "center",
                    "justify-content": "center",
                  },
                },
                actions: [
                  {
                    script: "",
                    data: [],
                  },
                ],
                scripts: [],
                layers: layout.children,
              },
              // scriptList: scriptList,
            };
            // console.log("previewBackground", previewBackground.includes("url"));

            await window.myApi.saveAppFileFunction(data, pageName, manifest);
          });
        });
      /** export json*/

      /** run app*/
      // document
      //   .querySelector("nav .run-button")
      //   .addEventListener("click", () => {
      //     window.myApi.openNewAppWindowFunction(
      //       "DemoAppText/demo2/page.json",
      //       manifest
      //     );
      //   });
      document
        .querySelector("nav .run-button")
        .addEventListener("click", () => {
          window.myApi.openNewAppWindowFunction(
            `DemoAppText/${manifest.appname}/page1.json`,
            manifest
          );
        });
      /** run app*/
      /** sd-button*/

      document
        .querySelector(".imageParamsBar .sd-button")
        .addEventListener("click", async () => {
          let sd = new Finalize_SD();
          // await sd.generate();
          window.myApi.openNewWindowFunction("http://127.0.0.1:7860");
        });
      /** sd-button*/
      document
        .querySelector("nav .right .version-button")
        .addEventListener("click", () => {
          const ModalWindowElement = document.createElement("div");

          const tem = new ModalWindow(ModalWindowElement, {
            name: "ModalWindow",
            frame: {
              width: "404px",
              height: "334px",
            },
            attributes: {
              isModal: "true",
              title: "App Version",
              confirmButtonText: "Save",
              cancelButtonText: "</> Script Editor",
            },
            content: {
              text: "<div id='appVersion-code-editor' style='width:100%;height:235px;border-radius: 4px;overflow: hidden;'></div>",
            },
            style: {},
          });
          tem.startDrawing("editor .preview-container");
          /** CodeMirror*/
          const codeEditor2 = CodeMirror(
            document.getElementById("appVersion-code-editor"),
            {
              value: `${JSON.stringify(manifest, null, 2)}`,
              mode: "javascript",
              theme: "darcula",
              lineNumbers: true,
              scrollbarStyle: "null",
              smartIndent: true,
              tabSize: 2,
              lineWrapping: true,
              showHint: true,
              autoCloseBrackets: true,
              matchBrackets: true,
            }
          );
          const editorValue2 = codeEditor2.getValue();
          console.log("编辑器的值已更改为：", editorValue2);
          codeEditor2.on("blur", (editor, changeObj) => {
            // changeObj 包含有关变化的信息，例如插入、删除的文本、位置等

            manifest = JSON.parse(codeEditor2.getValue());
            document
              .querySelectorAll(".preview .windowBar .title")
              .forEach((item) => {
                item.innerText = manifest.appname;
              });
          });
          /** CodeMirror*/
        });

      /** page-button*/

      // 获取父元素
      const pageContainer1 = document.querySelector(
        "nav .center .page-container"
      );
      pageContainer1.querySelector("p").style.color = "#c5c6c9";
      pageContainer1.querySelector(".page-content").style.background =
        "url(./framework/Assets/editor/page-content-active.svg) no-repeat center center";

      // 添加点击事件监听器到父元素
      pageContainer1.addEventListener("click", async function () {
        await html2canvas(document.querySelectorAll(".preview.showFlex")[0], {
          willReadFrequently: true,
        }).then((canvas) => {
          console.log(
            "1111",
            document
              .querySelector(".center .pageList .active")
              .getAttribute("data-page")
          );
          canvas.style.width = "38px";
          canvas.style.height = "31px";
          canvas.style.borderRadio = "4px";
          canvas.style.overflow = "hidden";
          document.querySelector(
            ".center .pageList .active .page-content"
          ).innerHTML = "";
          document
            .querySelector(".center .pageList .active .page-content")
            .appendChild(canvas);
        });
        document
          .querySelectorAll("nav .center .page-container")
          .forEach((item) => {
            item.classList.remove("active");
          });

        document
          .querySelectorAll("nav .center .page-container > p")
          .forEach((item) => {
            item.style.color = "#7F8188";
          });
        document
          .querySelectorAll("nav .center .page-container > .page-content")
          .forEach((item) => {
            item.style.cssText = `
            background: url(./framework/Assets/editor/page-container.svg) no-repeat
          center center;
            `;
          });

        document
          .querySelectorAll("#editor .preview-container .preview")
          .forEach((item) => {
            if (
              item.getAttribute("data-preview") ===
              pageContainer1.getAttribute("data-page")
            ) {
              item.classList.remove("hideBlock");
              item.classList.add("showFlex");
            } else {
              item.classList.remove("showFlex");
              item.classList.add("hideBlock");
            }
          });

        pageContainer1.classList.add("active");
        pageContainer1.querySelector("p").style.color = "#c5c6c9";
        pageContainer1.querySelector(".page-content").style.background =
          "url(./framework/Assets/editor/page-content-active.svg) no-repeat center center";

        /** click preview showFlex */
        document
          .querySelectorAll(".preview.showFlex")[0]
          .addEventListener("mousedown", () => {
            onblurElement();
            selectObj = event.target;
            document
              .querySelectorAll(".parametersBar > div")
              .forEach((item) => {
                if (item.classList.contains("windowParamsBar")) {
                  item.classList.add("showBlock");
                  item.classList.remove("hideBlock");
                } else {
                  item.classList.add("hideBlock");
                  item.classList.remove("showBlock");
                }
              });

            document
              .querySelectorAll(".preview.showFlex .draggable")
              .forEach((item) => {
                console.log(item);
                item.addEventListener("mousedown", () => {
                  event.stopPropagation();
                  console.log("draggable");
                  document.querySelectorAll(
                    ".preview.showFlex"
                  )[0].style.border = "none";
                  document
                    .querySelectorAll(".preview.showFlex")[0]
                    .classList.remove("showAfter");
                });
              });
          });
        /** click preview showFlex */
      });

      document
        .querySelector("nav .center .page-add-button")
        .addEventListener("click", () => {
          let tab = document.createElement("div");
          tab.classList.add("page-container");
          tab.setAttribute(
            "data-page",
            Number(
              document
                .querySelector("nav .center .pageList")
                .lastElementChild.getAttribute("data-page")
            ) + 1
          );
          tab.innerHTML = `
            <div class="page-content"></div>
            <p>Page${
              Number(
                document
                  .querySelector("nav .center .pageList")
                  .lastElementChild.getAttribute("data-page")
              ) + 1
            }</p>
          `;
          document.querySelector("nav .center .pageList").appendChild(tab);

          // 添加点击事件监听器到父元素
          tab.addEventListener("click", async function () {
            let preTabIndex = document
              .querySelector(".center .pageList .active")
              .getAttribute("data-page");
            console.log(
              "tab",

              preTabIndex
            );
            await html2canvas(
              document.querySelectorAll(".preview.showFlex")[0],
              {
                willReadFrequently: true,
              }
            ).then((canvas) => {
              console.log(
                "tab2",

                preTabIndex
              );
              canvas.style.width = "38px";
              canvas.style.height = "31px";
              canvas.style.borderRadio = "4px";
              canvas.style.overflow = "hidden";
              document.querySelector(
                `.center .pageList .active .page-content`
              ).innerHTML = "";
              document
                .querySelector(`.center .pageList .active .page-content`)
                .appendChild(canvas);
            });

            document
              .querySelectorAll("nav .center .page-container")
              .forEach((item) => {
                item.classList.remove("active");
              });
            document
              .querySelectorAll("nav .center .page-container > p")
              .forEach((item) => {
                item.style.color = "#7F8188";
              });
            document
              .querySelectorAll("nav .center .page-container > .page-content")
              .forEach((item) => {
                item.style.cssText = `
            background: url(./framework/Assets/editor/page-container.svg) no-repeat
          center center;
            `;
              });

            document
              .querySelectorAll("#editor .preview-container .preview")
              .forEach((item) => {
                if (
                  item.getAttribute("data-preview") ===
                  tab.getAttribute("data-page")
                ) {
                  item.classList.remove("hideBlock");
                  item.classList.add("showFlex");
                } else {
                  item.classList.remove("showFlex");
                  item.classList.add("hideBlock");
                }
              });

            tab.classList.add("active");
            tab.querySelector("p").style.color = "#c5c6c9";
            tab.querySelector(".page-content").style.background =
              "url(./framework/Assets/editor/page-content-active.svg) no-repeat center center";

            /** click preview showFlex */

            document
              .querySelectorAll(".preview.showFlex")[0]
              .addEventListener("mousedown", () => {
                console.log("event.target", event.target);
                selectObj = event.target;
                onblurElement();
                document
                  .querySelectorAll(".parametersBar > div")
                  .forEach((item) => {
                    if (item.classList.contains("windowParamsBar")) {
                      item.classList.add("showBlock");
                      item.classList.remove("hideBlock");
                    } else {
                      item.classList.add("hideBlock");
                      item.classList.remove("showBlock");
                    }
                  });

                document
                  .querySelectorAll(".preview.showFlex .draggable")
                  .forEach((item) => {
                    console.log(item);
                    item.addEventListener("mousedown", () => {
                      event.stopPropagation();
                      console.log("draggable");
                      document.querySelectorAll(
                        ".preview.showFlex"
                      )[0].style.border = "none";
                      document
                        .querySelectorAll(".preview.showFlex")[0]
                        .classList.remove("showAfter");
                    });
                  });
              });
            /** click preview showFlex */
          });

          /** */
          let tabContent = document.createElement("div");
          tabContent.classList.add("preview", "draggableBox", "hideBlock");
          tabContent.setAttribute(
            "data-preview",
            Number(
              document
                .querySelector("nav .center .pageList")
                .lastElementChild.getAttribute("data-page")
            )
          );
          tabContent.innerHTML = `

          <div class="draggableBox-rightBottom"></div>
          <div class="draggableBox-leftTop"></div>
          <div class="draggableBox-rightTop"></div>
          <div class="draggableBox-leftBottom"></div>
          <div class="windowBar">
            <div class="title">${manifest.appname}</div>
          </div>
          <div class="preview-content">
            <div class="offsetLeft"></div>
            <div class="offsetTop"></div>
          </div>

          `;
          document
            .querySelector("#editor .preview-container")
            .appendChild(tabContent);

          console.log(
            ' document.querySelectorAll(".preview.showFlex")[0]',
            document
              .querySelectorAll(".preview.showFlex")[0]
              .querySelector(".preview-content").style.background
          );
          tabContent.querySelector(".preview-content").style.background =
            document
              .querySelectorAll(".preview.showFlex")[0]
              .querySelector(".preview-content").style.background;
          new Sortable(tabContent.querySelector(".preview-content"), {
            group: {
              name: "nested",
              put: true, // 允许从其他容器拖拽放置到此容器
            },
            animation: 150,
            forceFallback: true,

            // draggable: ".draggableBox",
            draggable: ".component-contain",
            handle: ".move",
            dragClass: "dragMove",
            onStart: function (evt) {
              hideOffsetLine();
              hideTippy();
            },
            onEnd: function (evt) {},

            onAdd: function (evt) {
              console.log("1add");
              if (
                evt.item.classList.contains("draggableBox") &&
                !hasTippyInstance(evt.item)
              ) {
                tippyInstance = tippy(evt.item, {
                  placement: "bottom",
                  trigger: "click",
                  onShow(instance) {
                    // 在工具提示显示时更新内容
                    const width = origEl.clientWidth; // 获取元素的宽度
                    const height = origEl.clientHeight; // 获取元素的高度
                    instance.setContent(`${width - 8} x ${height - 8}`);
                  },
                });
                tippyInstances.push(tippyInstance);
                console.log("1tippyInstances");
                //         setTimeout(() => {
                //           console.log("reference", tippyInstance.reference.id);
                //           scriptList.push({
                //             name: tippyInstance.reference.id,
                //             content: `function helloWorld() {
                //   console.log(' Hello, ${tippyInstance.reference.id}!');
                // }`,
                //           });
                //         }, 10);
              }

              hideOffsetLine();
              let origEl = evt.item;
              //   console.log("add", origEl, evt, origEl.firstElementChild);
              if (origEl.classList.contains("draggableBox")) {
                origEl.removeEventListener("click", getComponentAtr);
                origEl.addEventListener("click", getComponentAtr);
              }
              for (const property in indexData) {
                // 获取原始对象的id
                var originalId = evt.item.id;

                // 将克隆后的对象的id设置为原始对象id加一
                if (property == originalId) {
                  var cloneId = originalId + `_${indexData[property]}`;
                  // 设置克隆后的对象的id
                  evt.clone.id = evt.item.id;
                  evt.item.id = cloneId.toString();

                  if (property.includes("-")) {
                    switch (property.split("-")[0]) {
                      case "Button":
                        break;
                      case "Text":
                        break;
                      case "Input":
                        break;
                    }
                  } else {
                    let tem;
                    switch (property) {
                      case "VStack":
                        break;
                      case "HStack":
                        break;
                      case "ImgLoader":
                        attributes.push({
                          id: evt.item.id,
                          content: [
                            { name: "isCanvas", state: false },
                            { name: "isPens", state: false },
                            { name: "isImgCompare", state: false },
                          ],
                        });
                        console.log("attributes", attributes);
                        break;
                      case "ImgViewer":
                        break;
                      case "NavigationBar":
                        tem = new NavigationBar(
                          document.createElement("div"),
                          {}
                        );
                        tem.renderingStyle(evt.item, evt.item.id);
                        break;
                      case "CheckBox":
                        console.log(evt.item, evt.item.id, evt.clone);
                        tem = new CheckBox(document.createElement("div"), {});
                        tem.renderingStyle(evt.item, evt.item.id);
                        break;
                      case "TreeSelector":
                        tem = new TreeSelector(
                          document.createElement("div"),
                          {}
                        );
                        tem.renderingStyle(evt.item, evt.item.id);
                        break;
                      case "Radio":
                        tem = new SingleButton(
                          document.createElement("div"),
                          {}
                        );
                        tem.renderingStyle(evt.item, evt.item.id);
                        break;
                      case "TabBar":
                        tem = new BookmarkPage(
                          document.createElement("div"),
                          {}
                        );
                        tem.renderingStyle(evt.item, evt.item.id);
                        break;
                      case "ChoiceColumn":
                        tem = new ChoiceColumn(
                          document.createElement("div"),
                          {}
                        );
                        tem.renderingStyle(evt.item, evt.item.id);
                        break;
                      case "Slider":
                        tem = new Slider(document.createElement("div"), {});
                        tem.renderingStyle(evt.item, evt.item.id);
                        break;
                      case "ParameterBlock":
                        break;
                      case "DropDownMenu":
                        tem = new DropDownMenu(
                          document.createElement("div"),
                          {}
                        );
                        tem.renderingStyle(evt.item, evt.item.id);
                        break;
                      case "ModalWindow":
                        break;
                      case "PromptInforma":
                        break;
                    }
                  }

                  indexData[property] += 1;
                }
              }

              //
              let previewComponents = document.querySelectorAll(
                ".preview .draggableBox "
              );

              function getComponentAtr() {
                event.stopPropagation();
                console.log("getComponentAtr", origEl);

                if (
                  origEl.lastElementChild.id === "ImgLoader" ||
                  origEl.lastElementChild.id === "ImgViewer"
                ) {
                  document.querySelector(
                    ".parametersBar .parameters .attributes"
                  ).style.display = "flex";
                  document.querySelector(
                    ".parametersBar .parameters .other >div:nth-of-type(1)"
                  ).style.display = "flex";
                  document.querySelector(
                    ".parametersBar .parameters .content .loader-icon"
                  ).style.display = "block";
                  document.querySelector(
                    ".parametersBar .parameters .content .loader-background"
                  ).style.display = "block";
                } else {
                  document.querySelector(
                    ".parametersBar .parameters .attributes"
                  ).style.display = "none";
                  document.querySelector(
                    ".parametersBar .parameters .other >div:nth-of-type(1)"
                  ).style.display = "none";
                  document.querySelector(
                    ".parametersBar .parameters .content .loader-icon"
                  ).style.display = "none";
                  document.querySelector(
                    ".parametersBar .parameters .content .loader-background"
                  ).style.display = "none";
                }

                /** parametersBar show */
                document
                  .querySelectorAll(".parametersBar >div")
                  .forEach((item) => {
                    if (item.classList.contains("parameters")) {
                      item.classList.remove("hideBlock");
                      item.classList.add("showBlock");
                    } else {
                      item.classList.remove("showBlock");
                      item.classList.add("hideBlock");
                    }
                  });
                /** parametersBar show */

                hideOffsetLine();

                showOffsetLine(origEl);

                document.querySelectorAll(".preview.showFlex")[0].style.border =
                  "none";
                document
                  .querySelectorAll(".preview.showFlex")[0]
                  .classList.remove("showAfter");

                origEl.style.border = "solid 2px #0f81e6";
                origEl.classList.add("showAfter");

                let ele;
                if (origEl.id.includes("_")) {
                  ele = origEl.id.split("_")[0];
                } else {
                  ele = origEl.id;
                }
                let parameters = document.querySelector("#editor .parameters");
                textObj = origEl.lastElementChild;
                selectObj = origEl;
                window.data.selectObj = selectObj;

                switch (ele) {
                  case "PrimaryBtn":
                    textObj = origEl.querySelector(".button-text");
                    break;
                  case "Button":
                    textObj = origEl.querySelector(".button-text");
                    break;
                  case "Input":
                    textObj = origEl.querySelector(".input-text");
                    document.querySelector(
                      ".parameters .content .placeholder-input input"
                    ).placeholder = origEl.querySelector("input").placeholder;
                    break;

                  case "Slider":
                    document.querySelector(
                      ".parameters .content .minimum-input input"
                    ).value = origEl.querySelector("input").min;
                    document.querySelector(
                      ".parameters .content .maximum-input input"
                    ).value = origEl.querySelector("input").max;
                    document.querySelector(
                      ".parameters .content .default-value-input input"
                    ).value = origEl.querySelector("input").value;
                    document.querySelector(
                      ".parameters .content .slider-step-input input"
                    ).value = origEl.querySelector("input").step;
                    break;

                  case "CheckBox":
                    textObj = origEl.querySelector(".checkbox-text");
                    break;
                  case "ParameterBlock":
                    textObj = origEl.querySelector(".parameterBlock-text");
                    break;
                  case "NavigationBar":
                    watchChoiceBox(".layout-choiceBox");
                    break;
                  case "TabBar":
                    textObj = origEl.querySelector(".tabs");
                    break;
                  case "ChoiceColumn":
                    window.data.choiceColumnList = [];
                    document
                      .querySelectorAll(`#${selectObj.id} .container-item`)
                      .forEach((item, index) => {
                        const regex = /url\("(.*?)"/;
                        const match =
                          item.firstElementChild.style.background.match(regex);

                        // 提取匹配到的URL
                        if (match) {
                          const url = match[1];
                          window.data.choiceColumnList.push({
                            url: url,
                            name: selectObj.id,
                            title: item.querySelector("p").innerText,
                            active: false,
                          });
                        }
                      });
                    break;
                  case "ImgLoader":
                    textObj = origEl.querySelector(".imageUploader-text");

                    if (
                      !origEl
                        .querySelector(".imageUploader-icon")
                        .src.includes("/framework/Assets/uploadCloud.svg")
                    ) {
                      document
                        .querySelector(
                          ".parameters .loader-icon  .theme-fileName"
                        )
                        .querySelector("div:nth-of-type(1)").innerText = origEl
                        .querySelector(".imageUploader-icon")
                        .src.split("/")
                        .pop();
                      document.querySelector(
                        ".parameters .loader-icon  .theme-fileName"
                      ).style.display = "flex";
                      document.querySelector(
                        ".parameters .icon-image-button"
                      ).style.display = "none";
                    } else {
                      document.querySelector(
                        ".parameters .loader-icon  .theme-fileName"
                      ).style.display = "none";
                      document.querySelector(
                        ".parameters .icon-image-button"
                      ).style.display = "block";
                    }
                    if (
                      origEl.querySelector(".imageUploader-input-contain").style
                        .background
                    ) {
                      document
                        .querySelector(
                          ".parameters .loader-background  .theme-fileName"
                        )
                        .querySelector("div:nth-of-type(1)").innerText = origEl
                        .querySelector(".imageUploader-input-contain")
                        .style.background.split("/")
                        .pop();
                      document.querySelector(
                        ".parameters .loader-background  .theme-fileName"
                      ).style.display = "flex";
                      document.querySelector(
                        ".parameters .image-button"
                      ).style.display = "none";
                    } else {
                      document.querySelector(
                        ".parameters .loader-background  .theme-fileName"
                      ).style.display = "none";
                      document.querySelector(
                        ".parameters .image-button"
                      ).style.display = "block";
                    }
                    break;
                  case "Image":
                    if (
                      !origEl.lastElementChild.style.background.includes(
                        "/framework/Assets/editor/image-background.svg"
                      )
                    ) {
                      document
                        .querySelector(
                          ".parameters .loader-background  .theme-fileName"
                        )
                        .querySelector("div:nth-of-type(1)").innerText =
                        origEl.lastElementChild.style.background
                          .split("/")
                          .pop();
                      document.querySelector(
                        ".parameters .loader-background  .theme-fileName"
                      ).style.display = "flex";
                      document.querySelector(
                        ".parameters .image-button"
                      ).style.display = "none";
                    } else {
                      document.querySelector(
                        ".parameters .loader-background  .theme-fileName"
                      ).style.display = "none";
                      document.querySelector(
                        ".parameters .image-button"
                      ).style.display = "block";
                    }
                    break;
                  case "Button":
                    textObj = origEl.querySelector(".button-text");
                    break;
                  case "PrimaryBtn":
                    textObj = origEl.querySelector(".button-text");
                    break;
                }

                showModuleScript();
                showItemList();
                /** 修改preview 颜色块显示颜色*/

                if (textObj.id === "Radio") {
                  document.querySelector(
                    "#editor .parameters .content .color-picker .picker-input input"
                  ).value = rgbaToHexAndAlpha(
                    textObj.querySelector(".custom-radio").style.color
                  )[0];
                  document.querySelector(
                    "#editor .parameters .content .color-picker .picker-opacity input"
                  ).value = rgbaToHexAndAlpha(
                    textObj.querySelector(".custom-radio").style.color
                  )[1];
                } else if (textObj.id === "TreeSelector") {
                  document.querySelector(
                    "#editor .parameters .content .color-picker .picker-input input"
                  ).value = rgbaToHexAndAlpha(
                    textObj.querySelector(".tree-checkbox-text").style.color
                  )[0];
                  document.querySelector(
                    "#editor .parameters .content .color-picker .picker-opacity input"
                  ).value = rgbaToHexAndAlpha(
                    textObj.querySelector(".tree-checkbox-text").style.color
                  )[1];
                } else if (textObj.id === "DropDownMenu") {
                  document.querySelector(
                    "#editor .parameters .content .color-picker .picker-input input"
                  ).value = rgbaToHexAndAlpha(
                    textObj.querySelector(".title").style.color
                  )[0];
                  document.querySelector(
                    "#editor .parameters .content .color-picker .picker-opacity input"
                  ).value = rgbaToHexAndAlpha(
                    textObj.querySelector(".title").style.color
                  )[1];
                } else {
                  document.querySelector(
                    "#editor .parameters .content .color-picker .picker-input input"
                  ).value = rgbaToHexAndAlpha(textObj.style.color)[0];
                  document.querySelector(
                    "#editor .parameters .content .color-picker .picker-opacity input"
                  ).value = rgbaToHexAndAlpha(textObj.style.color)[1];
                }

                /** 修改preview 颜色块显示颜色*/

                parameters.querySelector(".ele-title h4").innerText = origEl.id;

                if (attributes.length !== 0) {
                  let attributesEle = document.querySelector(
                    "#editor .parameters .attributes"
                  );

                  let contentHTML = ""; // 用于存储 content 内容的HTML

                  attributes.forEach((item) => {
                    if (item.id === origEl.id) {
                      contentHTML = item.content
                        .map((item2) => {
                          return `<div class="${item2.name}-item item">
                  <div>
                    <input type="checkbox" id="inputId-${item2.name}" ${
                            item2.state ? "checked" : ""
                          } />
                    <label for="inputId-${item2.name}"></label>
                  </div>


                </div>`;
                        })
                        .join("");
                    }
                  });

                  attributesEle.innerHTML = `
                      ${contentHTML}
                      `;
                  attributesEle
                    .querySelectorAll(".item input[type='checkbox']")
                    .forEach((item, index) => {
                      item.addEventListener("change", () => {
                        attributes.forEach((item) => {
                          if (item.id === origEl.id) {
                            item.content.forEach((item2, index2) => {
                              if (index === index2) {
                                item2.state = event.target.checked;
                                console.log(
                                  "event.target.checked",
                                  event.target.checked
                                );
                                let atr = event.target.id.split("-")[1];
                                const imageUploaderElement =
                                  document.createElement("div");
                                let tem;
                                switch (atr) {
                                  case "isCanvas":
                                    if (event.target.checked) {
                                      document
                                        .querySelector(
                                          `#editor .preview #${selectObj.id} `
                                        )
                                        .setAttribute("isCanvas", "true");
                                      document.querySelector(
                                        `#editor .preview #${selectObj.id} `
                                      ).innerHTML = `
              <canvas class="tool-canvas" width= "100%" height= "100%" style=" border-radius: 8px; background-color: #fff;width: 100%;height: 100%;" >
              </canvas>
          <div class="mouse" style="left: 0;top: 0;position: absolute;width: 16px;height:16px; background: url('./framework/Assets/pens.svg') no-repeat center center /cover; display: none;"></div>
          <div style="display: flex;justify-content: space-between">
            <div id="eraserButton" style="cursor: pointer;width: 20px;height: 20px; background: url('./framework/Assets/eraserButton.svg') no-repeat center center / cover"></div>
            <div id="penButton" style="cursor: pointer;width: 20px;height: 20px; background: url('./framework/Assets/penButton.svg') no-repeat center center / cover"></div>
            <div id="clearCanvasBtn" style="cursor: pointer;width: 20px;height: 20px; background: url('./framework/Assets/clearCanvasBtn.svg') no-repeat center center / cover"></div>
            <div id="backCanvasBtn" style="cursor: pointer;width: 20px;height: 20px; background: url('./framework/Assets/backCanvasBtn.svg') no-repeat center center / cover"></div>
          </div>
                                          `;
                                    } else {
                                      tem = new ImageUploader(
                                        imageUploaderElement,
                                        {
                                          name: "ImgLoader",
                                          frame: {
                                            width: "100%",
                                            height: "100%",
                                          },
                                          attributes: {},
                                          class: [],
                                          content: {},
                                          style: {},
                                          actions: [],
                                          scripts: [],
                                        }
                                      );
                                      document
                                        .querySelector(
                                          `#editor .preview #${selectObj.id} `
                                        )
                                        .removeAttribute("isCanvas");
                                      document.querySelector(
                                        `#editor .preview #${selectObj.id} `
                                      ).innerHTML = "";
                                      tem.startDrawing(
                                        `editor .preview #${selectObj.id} `
                                      );
                                    }

                                    break;
                                  case "isPens":
                                    if (event.target.checked) {
                                      document
                                        .querySelector(
                                          `#editor .preview #${selectObj.id} `
                                        )
                                        .setAttribute("isPens", "true");
                                      document.querySelector(
                                        `#editor .preview #${selectObj.id} `
                                      ).innerHTML = `
                                            <div class="draggableBox-rightBottom"></div>
                                            <div class="draggableBox-leftTop"></div>
                                            <div class="draggableBox-rightTop"></div>
                                            <div class="draggableBox-leftBottom"></div>
                                            <div class="moveArea move"></div>
                                          `;
                                      tem = new ImageUploader(
                                        imageUploaderElement,
                                        {
                                          name: "ImgLoader",
                                          frame: {
                                            width: "100%",
                                            height: "100%",
                                          },
                                          attributes: {
                                            isPens: "true",
                                          },
                                          class: [],
                                          content: {},
                                          style: {},
                                          actions: [],
                                          scripts: [],
                                        }
                                      );

                                      tem.startDrawing(
                                        `editor .preview #${selectObj.id} `
                                      );
                                    } else {
                                      tem = new ImageUploader(
                                        imageUploaderElement,
                                        {
                                          name: "ImgLoader",
                                          frame: {
                                            width: "100%",
                                            height: "100%",
                                          },
                                          attributes: {},
                                          class: [],
                                          content: {},
                                          style: {},
                                          actions: [],
                                          scripts: [],
                                        }
                                      );
                                      document
                                        .querySelector(
                                          `#editor .preview #${selectObj.id} `
                                        )
                                        .removeAttribute("isPens");
                                      document.querySelector(
                                        `#editor .preview #${selectObj.id} `
                                      ).innerHTML = `
                                            <div class="draggableBox-rightBottom"></div>
                                            <div class="draggableBox-leftTop"></div>
                                            <div class="draggableBox-rightTop"></div>
                                            <div class="draggableBox-leftBottom"></div>
                                            <div class="moveArea move"></div>
                                            `;
                                      tem.startDrawing(
                                        `editor .preview #${selectObj.id} `
                                      );
                                    }
                                    break;
                                  case "isImgCompare":
                                    break;
                                  default:
                                    break;
                                }
                              }
                            });
                          }
                        });
                      });
                    });
                }

                parameters.querySelector(
                  ".frame  div:nth-of-type(1) input"
                ).value = origEl.style.marginLeft.split("px")[0]
                  ? origEl.style.marginLeft.split("px")[0]
                  : 0;
                parameters.querySelector(
                  ".frame  div:nth-of-type(2) input"
                ).value = origEl.style.marginTop.split("px")[0]
                  ? origEl.style.marginTop.split("px")[0]
                  : 0;
                parameters.querySelector(
                  ".frame  div:nth-of-type(3) input"
                ).value = origEl.style.width.split("px")[0];
                parameters.querySelector(
                  ".frame  div:nth-of-type(4) input"
                ).value = origEl.style.height.split("px")[0];

                if (textObj) {
                  parameters.querySelector(".content ").style.display = "block";
                  if (
                    ele === "TreeSelector" ||
                    ele === "Radio" ||
                    ele === "DropDownMenu" ||
                    ele === "TabBar" ||
                    ele === "NavigationBar"
                  ) {
                    // 使用换行符分割文本内容成多个行
                    let lines = textObj.innerText.split("\n");

                    // 创建一个空数组来存储结果
                    let result = [];

                    // 遍历每一行文本，去除首尾空白字符，然后添加到结果数组中
                    for (let i = 0; i < lines.length; i++) {
                      let line = lines[i].trim();
                      if (line.length > 0) {
                        result.push(line);
                      }
                    }

                    let contentHTML = ""; // 用于存储 content 内容的HTML
                    let number, name;

                    if (ele === "Radio") {
                      name = "Option";
                    }
                    if (ele === "TabBar") {
                      name = "Tab";
                    }
                    if (ele === "NavigationBar") {
                      name = "Item";

                      contentHTML = result
                        .map((item, index) => {
                          number = index + 1;
                          return `
                        <div style="width: 100%; height: 21px; display: flex;  margin-top: 15px; margin-bottom: 10px;">
                        <div class="navBar-item-input">
                          <div class="title">${name}${number}</div>
                          <input type="text" value='${item}' />
                        </div>
                        <img class="editor-button" style="margin: 0 3px;width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-editor.svg">
                        <img class="delete-button" style="width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-delete.svg">
                        </div>     
                        `;
                        })
                        .join("");
                      contentHTML += `
                  <div class="button-none">
                    + Add Option
                    </div>

                    `;

                      parameters.querySelector(
                        ".content  .optionsList"
                      ).innerHTML = `${contentHTML}`;

                      parameters
                        .querySelector(".content  .optionsList .button-none")
                        .addEventListener("click", () => {
                          number++;
                          let optionItem = document.createElement("div");
                          optionItem.style.cssText = `
width: 100%; height: 21px; display: flex;  margin-top: 15px; margin-bottom: 10px;
`;
                          optionItem.innerHTML = `
                        
                        <div class="navBar-item-input">
                          <div class="title">${name}${number}</div>
                          <input type="text" value='xx' />
                        </div>
                        <img class="editor-button" style="margin: 0 3px;width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-editor.svg">
                        <img class="delete-button" style="width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-delete.svg">
                        
                      `;

                          // 获取当前点击元素的父元素
                          let parentElement = event.target.parentElement;

                          // 获取当前点击元素在父元素子节点中的位置
                          let currentIndex = Array.from(
                            parentElement.children
                          ).indexOf(event.target);

                          // 使用 insertBefore 方法将新元素插入到当前点击元素的前一个位置
                          parentElement.insertBefore(
                            optionItem,
                            parentElement.children[currentIndex]
                          );
                          handleContent();
                        });
                    } else {
                      contentHTML = result
                        .map((item, index) => {
                          number = index + 1;
                          return `
                        <div style="width: 100%; height: 21px; display: flex;  margin-top: 15px; margin-bottom: 10px;">
                        <div class="navBar-item-input">
                          <div class="title">${name}${number}</div>
                          <input type="text" value='${item}' />
                        </div>
                        <img class="delete-button" style="width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-delete.svg">
                        </div>  
                                 
  
                                `;
                        })
                        .join("");
                      contentHTML += `
                  <div class="button-none">
                    + Add Option
                    </div>

                    `;

                      parameters.querySelector(
                        ".content  .optionsList"
                      ).innerHTML = `${contentHTML}`;

                      parameters
                        .querySelector(".content  .optionsList .button-none")
                        .addEventListener("click", () => {
                          number++;
                          let optionItem = document.createElement("div");
                          optionItem.style.cssText = `
width: 100%; height: 21px; display: flex;  margin-top: 15px; margin-bottom: 10px;
`;
                          optionItem.innerHTML = `
                       
                        <div class="navBar-item-input">
                          <div class="title">${name}${number}</div>
                          <input type="text" value='xx' />
                        </div>
                        <img class="delete-button" style="width: 14px; cursor:pointer; margin-right: 2px;" src="./framework/Assets/editor/add-script-delete.svg">
                         
                      `;

                          // 获取当前点击元素的父元素
                          let parentElement = event.target.parentElement;

                          // 获取当前点击元素在父元素子节点中的位置
                          let currentIndex = Array.from(
                            parentElement.children
                          ).indexOf(event.target);

                          // 使用 insertBefore 方法将新元素插入到当前点击元素的前一个位置
                          parentElement.insertBefore(
                            optionItem,
                            parentElement.children[currentIndex]
                          );
                          handleContent();
                        });
                    }
                    handleContent();
                  } else {
                    parameters.querySelector(
                      ".content  .inputBox input"
                    ).value = textObj.innerText;
                  }
                } else {
                  parameters.querySelector(".content ").style.display = "none";
                }
              }
            },
            onMove: function (evt) {
              //   console.log("onMove");
              hideOffsetLine();
            },
          });
        });
      document
        .querySelector("nav .center .page-delete-button")
        .addEventListener("click", () => {
          document
            .querySelectorAll("nav .center .pageList .page-container")
            .forEach((item) => {
              if (item.classList.contains("active")) {
                let tabIndex = item.getAttribute("data-page");
                let preTabPageIndex =
                  item.previousElementSibling.getAttribute("data-page");

                console.log("page-delete-button", tabIndex);
                if (tabIndex == 1) {
                  return;
                }

                item.remove();
                document
                  .querySelectorAll("#editor .preview-container .preview")
                  .forEach((item2) => {
                    if (item2.getAttribute("data-preview") === tabIndex) {
                      item2.remove();
                    }
                    if (item2.getAttribute("data-preview") == preTabPageIndex) {
                      item2.classList.remove("hideBlock");
                      item2.classList.add("showFlex");
                    } else {
                      item2.classList.remove("showFlex");
                      item2.classList.add("hideBlock");
                    }
                  });

                document
                  .querySelector(
                    `nav .center .pageList > div[data-page="${preTabPageIndex}"]`
                  )

                  .classList.add("active");
                document
                  .querySelector(
                    `nav .center .pageList > div[data-page="${preTabPageIndex}"]`
                  )

                  .querySelector("p").style.color = "#c5c6c9";
                document
                  .querySelector(
                    `nav .center .pageList > div[data-page="${preTabPageIndex}"]`
                  )

                  .querySelector(".page-content").style.background =
                  "url(./framework/Assets/editor/page-content-active.svg) no-repeat center center";
              }
            });
        });
      /** page-button*/

      /** imageParams*/
      document
        .querySelector(".components .image-params")
        .addEventListener("click", () => {
          document.querySelectorAll(".parametersBar > div").forEach((item) => {
            if (item.classList.contains("imageParamsBar")) {
              item.classList.add("showBlock");
              item.classList.remove("hideBlock");
            } else {
              item.classList.add("hideBlock");
              item.classList.remove("showBlock");
            }
          });
        });
      /** imageParams*/
      /** Switch windowBar*/
      document.querySelector(".windowBar .title ").innerText = manifest.appname;

      document
        .querySelector(".windowParamsBar .system .tabs ")
        .addEventListener("click", () => {
          if (event.target.innerText === "Mac") {
            document.querySelectorAll(".preview ").forEach((item) => {
              item.style.width = " 626px";
              item.style.height = "576px";
              item.style.background = "";
              item.style.backgroundColor = "#3c414e";
              item.querySelector(".preview-content").style.flex = "1";
              item.querySelector(".preview-content").style.height = "";
              item.querySelector(".preview-content").style.width = "100%";
              item.querySelector(".preview-content").style.top = "";
              item.querySelector(".preview-content").style.borderRadius = "";

              item.querySelector(".windowBar").style.display = "flex";
              item.querySelector(".windowBar").style.backgroundImage =
                "url(./framework/Assets/editor/mac-windowbar.svg)";
            });
          }
          if (event.target.innerText === "Windows") {
            document.querySelectorAll(".preview ").forEach((item) => {
              item.style.width = " 626px";
              item.style.height = "576px";
              item.style.background = "";
              item.style.backgroundColor = "#3c414e";
              item.querySelector(".preview-content").style.flex = "1";
              item.querySelector(".preview-content").style.height = "";
              item.querySelector(".preview-content").style.width = "100%";
              item.querySelector(".preview-content").style.top = "";
              item.querySelector(".preview-content").style.borderRadius = "";

              item.querySelector(".windowBar").style.display = "flex";
              item.querySelector(".windowBar").style.backgroundImage =
                "url(./framework/Assets/editor/window-windowbar.svg)";
            });
          }
          if (event.target.innerText === "Mobile") {
            document.querySelectorAll(".preview").forEach((item) => {
              item.querySelector(".windowBar").style.display = "none";
              item.style.background =
                "url(./framework/Assets/editor/iphoneBack.svg) no-repeat center center / contain";
              item.style.width = "271px";
              item.style.height = "550px";
              item.querySelector(".preview-content").style.flex = "none";
              item.querySelector(".preview-content").style.height = "88%";
              item.querySelector(".preview-content").style.width = "88%";
              item.querySelector(".preview-content").style.top = "9%";
              item.querySelector(".preview-content").style.borderRadius =
                "2px 2px 34px 34px";
            });
          }
        });

      /** Switch windowBar*/
      /** theme-button*/
      document
        .querySelector(".windowParamsBar .theme-button")
        .addEventListener("click", () => {
          let fileInput = document.querySelector(".theme-button-input");
          let themeFileName = document.querySelector(
            ".windowParamsBar .backgroundColor .theme-fileName"
          );
          fileInput.click();
          themeFileName
            .querySelector(".theme-delete-button")
            .addEventListener("click", () => {
              themeFileName.style.display = "none";
              document.querySelector(
                ".windowParamsBar .theme-button"
              ).style.display = "block";
              document
                .querySelectorAll(".preview .preview-content")
                .forEach((item) => {
                  item.style.background = "";
                });
            });
          fileInput.addEventListener("change", async function () {
            let selectedFile = fileInput.files[0];
            // 将本地文件路径转换为file:// URL
            let fileUrl = "file://" + selectedFile.path.replace(/\\/g, "/");
            let targetPath = await window.myApi.cloneFileFunction(
              selectedFile.path.replace(/\\/g, "/"),
              `DemoAppText/${manifest.appname}/assets`
            );
            console.log("fileUrl", fileUrl, selectedFile.name);
            themeFileName.querySelector("div:nth-of-type(1)").innerText =
              selectedFile.name;
            themeFileName.style.display = "flex";
            document.querySelector(
              ".windowParamsBar .theme-button"
            ).style.display = "none";
            document
              .querySelectorAll(".preview .preview-content")
              .forEach((item) => {
                item.style.background = `url(${targetPath})no-repeat  center center / cover`;
              });
          });
        });

      /** theme-button*/
      /** icon-image-button*/
      document
        .querySelector(".parameters .icon-image-button")
        .addEventListener("click", () => {
          let fileInput = document.querySelector(
            ".loader-icon .theme-button-input"
          );
          let themeFileName = document.querySelector(
            ".parameters .loader-icon  .theme-fileName"
          );
          fileInput.click();
          themeFileName
            .querySelector(" .theme-delete-button")
            .addEventListener("click", () => {
              themeFileName.style.display = "none";
              document.querySelector(
                ".parameters .icon-image-button"
              ).style.display = "block";

              if (
                document.querySelector(`#${selectObj.id} `).lastElementChild
                  .id === "ImgLoader"
              ) {
                document.querySelector(
                  `#${selectObj.id} .imageUploader-icon`
                ).src = `./framework/Assets/uploadCloud.svg`;
              }
              if (
                document.querySelector(`#${selectObj.id} `).lastElementChild
                  .id === "ImgViewer"
              ) {
                document.querySelector(
                  `#${selectObj.id} .icon img`
                ).src = `./framework/Assets/imageDisplay-icon.svg`;
              }
            });
          fileInput.addEventListener("change", async function () {
            let selectedFile = fileInput.files[0];
            console.log("selectedFile", selectedFile);
            // 将本地文件路径转换为file:// URL
            let fileUrl = "file://" + selectedFile.path.replace(/\\/g, "/");
            let targetPath = await window.myApi.cloneFileFunction(
              selectedFile.path.replace(/\\/g, "/"),
              `DemoAppText/${manifest.appname}/assets`
            );

            themeFileName.querySelector("div:nth-of-type(1)").innerText =
              selectedFile.name;
            themeFileName.style.display = "flex";
            document.querySelector(
              ".parameters .icon-image-button"
            ).style.display = "none";
            if (
              document.querySelector(`#${selectObj.id} `).lastElementChild
                .id === "ImgLoader"
            ) {
              document.querySelector(
                `#${selectObj.id} .imageUploader-icon`
              ).src = `${targetPath}`;
            }
            if (
              document.querySelector(`#${selectObj.id} `).lastElementChild
                .id === "ImgViewer"
            ) {
              document.querySelector(
                `#${selectObj.id} .icon img`
              ).src = `${targetPath}`;
            }
          });
        });
      /** icon-image-button*/
      /** image-button*/
      document
        .querySelector(".parameters .image-button")
        .addEventListener("click", () => {
          let fileInput = document.querySelector(
            ".loader-background .theme-button-input"
          );
          let themeFileName = document.querySelector(
            ".parameters .loader-background  .theme-fileName"
          );
          fileInput.click();
          themeFileName
            .querySelector(" .theme-delete-button")
            .addEventListener("click", () => {
              themeFileName.style.display = "none";
              document.querySelector(
                ".parameters .image-button"
              ).style.display = "block";

              if (selectObj.lastElementChild.id === "Image") {
                document.querySelector(
                  `#${selectObj.id}`
                ).lastElementChild.style.background = `url('./framework/Assets/editor/image-background.svg')no-repeat center center / cover`;
              } else {
                document.querySelector(
                  `#${selectObj.id} .imageUploader-input-contain`
                ).style.background = ``;
              }
            });
          fileInput.addEventListener("change", async function () {
            let selectedFile = fileInput.files[0];
            console.log("selectedFile", selectedFile);
            // 将本地文件路径转换为file:// URL
            let fileUrl = "file://" + selectedFile.path.replace(/\\/g, "/");
            let targetPath = await window.myApi.cloneFileFunction(
              selectedFile.path.replace(/\\/g, "/"),
              `DemoAppText/${manifest.appname}/assets`
            );
            console.log("fileUrl", fileUrl, selectedFile.name, targetPath);
            themeFileName.querySelector("div:nth-of-type(1)").innerText =
              selectedFile.name;
            themeFileName.style.display = "flex";
            document.querySelector(".parameters .image-button").style.display =
              "none";

            if (selectObj.lastElementChild.id === "Image") {
              document.querySelector(
                `#${selectObj.id}`
              ).lastElementChild.style.background = `url('${targetPath}')no-repeat center center / cover`;
            } else {
              document.querySelector(
                `#${selectObj.id} .imageUploader-input-contain`
              ).style.background = `url('${targetPath}') center center / contain`;
            }
          });
        });
      /** image-button*/

      /** window pickerColor*/

      const windowPickerColorObserver = new MutationObserver(
        (mutationsList, observer) => {
          // 遍历所有观察到的变动
          for (const mutation of mutationsList) {
            if (
              mutation.type === "attributes" &&
              mutation.attributeName === "value"
            ) {
              // 当 value 属性发生变化时触发
              const newValue = mutation.target.value;

              // 在这里执行处理新值的逻辑
              let rgbaColor = rgbaFromHexAndOpacity(
                document.querySelector(
                  "#editor .windowParamsBar .backgroundColor  .picker-input input"
                ).value,
                document.querySelector(
                  "#editor .windowParamsBar .backgroundColor  .picker-opacity input"
                ).value
              );
              document
                .querySelectorAll(".preview .preview-content")
                .forEach((item) => {
                  item.style.background = rgbaColor;
                });
            }
          }
        }
      );

      // 配置观察选项，监听属性值变化
      const windowPickerColorConfig = {
        attributes: true,
        attributeFilter: ["value"],
      };

      // 开始观察指定的 input 元素
      windowPickerColorObserver.observe(
        document.querySelector(
          ".windowParamsBar .backgroundColor .picker-input input"
        ),
        windowPickerColorConfig
      );
      windowPickerColorObserver.observe(
        document.querySelector(
          ".windowParamsBar .backgroundColor .picker-opacity input"
        ),
        windowPickerColorConfig
      );
      /** window pickerColor*/

      /**  delete dom */
      new Sortable(
        document.querySelector(".preview-container .delete-container"),
        {
          group: {
            name: "nested",
            put: true, // 允许从其他容器拖拽放置到此容器
          },
          animation: 150,
          sort: false,
          onAdd: function (evt) {
            evt.item.remove();
          },
        }
      );
      /** delete dom */
      /** add-script-button */
      document.querySelectorAll(".add-script-button").forEach((item) => {
        console.log("item", item);
        item.addEventListener("click", handleClick);

        async function handleClick() {
          addScriptItem(selectObj.id);
          showModuleScript();
        }
      });

      /** add-script-button */
      /** add-item-button */
      // function handleClick() {
      //     addScriptItem(selectObj.id);
      //     showModuleScript();
      //   }
      document
        .querySelector(".add-item-button")
        .addEventListener("click", () => {
          addItem(selectObj.id);
          showItemList();
        });

      /** add-item-button */

      /** script-editor-button */
      document.querySelectorAll(".script-editor-button").forEach((item) => {
        item.addEventListener("click", async () => {
          console.log("selectObj", selectObj);
          // if (parentId === "code-editor") {
          //   await window.myApi.openFileFunction(selectObj.id + ".js", manifest);
          // }
          if (event.target.parentNode.classList.contains("windowParamsBar")) {
            await window.myApi.saveFileFunction(
              `DemoAppText/${manifest.appname}/scripts`,
              `AppVersion.json`,
              JSON.stringify(manifest),
              true
            );
            await window.myApi.openFileFunction("AppVersion.json", manifest);
          }
        });
      });

      /** script-editor-button */
      /** watchJsFunction */
      // window.myApi.watchJsFunction((event, url, value) => {
      //   scriptList.forEach((item) => {
      //     if (item.name === url.split(".")[0]) {
      //       item.content = value;
      //       if (
      //         document.querySelector(".parameters .ele-title h4").innerText ==
      //         url.split(".")[0]
      //       ) {
      //         codeEditor.setValue(value);
      //       }
      //     }
      //   });
      //   if (url === "WindowScript.js") {
      //     windowCodeEditor.setValue(value);
      //   }
      // });
      /** watchJsFunction */
      /** watch backspace */
      document.addEventListener("keydown", (event) => {
        if (
          event.keyCode === 8 &&
          selectObj.classList.contains("component-contain") &&
          document
            .querySelectorAll(".preview.showFlex")[0]
            .querySelectorAll(".component-contain.showAfter")[0].id ==
            selectObj.id
        ) {
          hideOffsetLine();
          tippyInstances.forEach((item) => {
            item.hide();
          });
          selectObj.remove();
        }
      });
      /** watch backspace */
      /** watch ele-name*/
      let eleName = document.querySelector(".ele-title");
      console.log("eleName", eleName);
      eleName.addEventListener("click", () => {
        eleName.querySelector("h4").classList.remove("showBlock");
        eleName.querySelector("h4").classList.add("hideBlock");
        eleName.querySelector("img").classList.remove("showBlock");
        eleName.querySelector("img").classList.add("hideBlock");

        eleName.querySelector("input").value =
          eleName.querySelector("h4").innerText;
        eleName.querySelector("input").classList.remove("hideBlock");
        eleName.querySelector("input").classList.add("showBlock");
        eleName.querySelector("input").focus();
      });
      eleName.querySelector("input").addEventListener("blur", () => {
        eleName.querySelector("h4").classList.remove("hideBlock");
        eleName.querySelector("h4").classList.add("showBlock");
        eleName.querySelector("img").classList.remove("hideBlock");
        eleName.querySelector("img").classList.add("showBlock");

        eleName.querySelector("h4").innerText =
          eleName.querySelector("input").value;
        eleName.querySelector("input").classList.remove("showBlock");
        eleName.querySelector("input").classList.add("hideBlock");
        selectObj.id = eleName.querySelector("input").value;
      });
      /** watch ele-name*/
      /** watch placeholder-input */
      document
        .querySelector(".parameters .content .placeholder-input input")
        .addEventListener("change", () => {
          document.querySelector(`#${selectObj.id} input`).placeholder =
            event.target.value;
        });
      /** watch placeholder-input */
      /** watch slider-input */
      document
        .querySelector(".parameters .content .minimum-input input")
        .addEventListener("change", () => {
          document.querySelector(`#${selectObj.id} input`).min =
            event.target.value;
        });
      document
        .querySelector(".parameters .content .maximum-input input")
        .addEventListener("change", () => {
          document.querySelector(`#${selectObj.id} input`).max =
            event.target.value;
        });
      document
        .querySelector(".parameters .content .default-value-input input")
        .addEventListener("change", () => {
          document.querySelector(`#${selectObj.id} input`).value =
            event.target.value;
        });
      document
        .querySelector(".parameters .content .slider-step-input input")
        .addEventListener("change", () => {
          document.querySelector(`#${selectObj.id} input`).step =
            event.target.value;
        });
      /** watch slider-input */
    </script>

    <script></script>
  </body>
</html>
